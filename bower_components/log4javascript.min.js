define("log4javascript",[],function(){"use strict";function getUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})}function toBool(a){return Boolean(a)}function isFunction(a){return"function"==typeof a}function arrayContains(a,b){for(var c=!1,d=0,e=a.length;e>d;d++)if(a[d]===b){c=!0;break}return c}function arrayRemove(a,b){for(var c=-1,d=0,e=a.length;e>d;d++)if(a[d]===b){c=d;break}return c>=0?(a.splice(c,1),!0):!1}function handleError(a,b){logLog.error(a,b),log4javascript.dispatchEvent("error",{message:a,exception:b})}function isString(a){return"string"==typeof a}function isArray(a){return a instanceof Array}function isUndefined(a){return"undefined"==typeof a}function isNotUndefined(a){return!isUndefined(a)}function toStr(a){return a&&a.toString?a.toString():String(a)}function trim(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")}function splitIntoLines(a){var b=a.replace(/\r\n/g,"\n").replace(/\r/g,"\n");return b.split("\n")}function urlEncode(a){var b="";return b=isUndefined(window.encodeURIComponent)?window.escape(a).replace(/\+/g,"%2B").replace(/"/g,"%22").replace(/'/g,"%27").replace(/\//g,"%2F").replace(/=/g,"%3D"):encodeURIComponent(a)}function urlDecode(a){var b="";return b=isUndefined(window.decodeURIComponent)?window.unescape(a).replace(/%2B/g,"+").replace(/%22/g,'"').replace(/%27/g,"'").replace(/%2F/g,"/").replace(/%3D/g,"="):decodeURIComponent(a)}function getListenersPropertyName(a){return"__log4javascript_listeners__"+a}function extractBooleanFromParam(a,b){return isUndefined(a)?b:toBool(a)}function extractStringFromParam(a,b){return isUndefined(a)?b:String(a)}function extractIntFromParam(a,b){if(isUndefined(a))return b;try{var c=parseInt(a,10);return isNaN(c)?b:c}catch(d){return logLog.warn("Invalid int param "+a,d),b}}function extractFunctionFromParam(a,b){return isFunction(a)?a:b}function getExceptionMessage(a){var b="";return b=a.message?a.message:a.description?a.description:toStr(a)}function getUrlFileName(a){var b=Math.max(a.lastIndexOf("/"),a.lastIndexOf("\\"));return a.substr(b+1)}function getExceptionStringRep(a){if(a){var b="Exception: "+getExceptionMessage(a);try{a.lineNumber&&(b+=" on line number "+a.lineNumber),a.fileName&&(b+=" in file "+getUrlFileName(a.fileName))}catch(c){logLog.warn("Unable to obtain file and line information for error")}return showStackTraces&&a.stack&&(b+=newLine+"Stack trace:"+newLine+a.stack),b}return null}function getEvent(a,b){return b=b?b:window,a?a:b.event}function addEvent(a,b,c,d,e){if(e=e?e:window,a.addEventListener)a.addEventListener(b,c,d);else if(a.attachEvent)a.attachEvent("on"+b,c);else{var f=getListenersPropertyName(b);a[f]||(a[f]=[],a["on"+b]=function(a){a=getEvent(a,e);for(var c,d=getListenersPropertyName(b),f=this[d].concat([]);c=f.shift();)c.call(this,a)}),a[f].push(c)}}function removeEvent(a,b,c,d){if(a.removeEventListener)a.removeEventListener(b,c,d);else if(a.detachEvent)a.detachEvent("on"+b,c);else{var e=getListenersPropertyName(b);a[e]&&arrayRemove(a[e],c)}}function stopEventPropagation(a){a.stopPropagation?a.stopPropagation():isUndefined(a.cancelBubble)&&(a.cancelBubble=!0),a.returnValue=!1}function formatObjectExpansion(a,b,c){function d(a,b,c){function f(a){for(var b=splitIntoLines(a),d=1,e=b.length;e>d;d++)b[d]=c+b[d];return b.join(newLine)}var g,h,i,j,k,l,m;if(c=c||"",null===a)return"null";if("undefined"==typeof a)return"undefined";if("string"==typeof a)return f(a);if("object"==typeof a&&arrayContains(e,a)){try{l=toStr(a)}catch(n){l="Error formatting property. Details: "+getExceptionStringRep(n)}return l+" [already expanded]"}if(a instanceof Array&&b>0){for(e.push(a),l="["+newLine,i=b-1,j=c+"  ",k=[],g=0,h=a.length;h>g;g++)try{m=d(a[g],i,j),k.push(j+m)}catch(n){k.push(j+"Error formatting array member. Details: "+getExceptionStringRep(n))}return l+=k.join(","+newLine)+newLine+c+"]"}if("[object Date]"===Object.prototype.toString.call(a))return a.toString();if("object"==typeof a&&b>0){e.push(a),l="{"+newLine,i=b-1,j=c+"  ",k=[];for(g in a)try{m=d(a[g],i,j),k.push(j+g+": "+m)}catch(n){k.push(j+g+": Error formatting property. Details: "+getExceptionStringRep(n))}return l+=k.join(","+newLine)+newLine+c+"}"}return f(toStr(a))}var e=[];return d(a,b,c)}function Level(a,b){this.level=a,this.name=b}function Logger(a){this.name=a,this.parent=null,this.children=[];var b=[],c=null,d=this.name===rootLoggerName,e=this.name===nullLoggerName,f=null,g=!1;this.addChild=function(a){this.children.push(a),a.parent=this,a.invalidateAppenderCache()};var h=!0;this.getAdditivity=function(){return h},this.setAdditivity=function(a){var b=h!==a;h=a,b&&this.invalidateAppenderCache()},this.addAppender=function(a){e?handleError("Logger.addAppender: you may not add an appender to the null logger"):a instanceof log4javascript.Appender?arrayContains(b,a)||(b.push(a),a.setAddedToLogger(this),this.invalidateAppenderCache()):handleError('Logger.addAppender: appender supplied ("'+toStr(a)+'") is not a subclass of Appender')},this.removeAppender=function(a){arrayRemove(b,a),a.setRemovedFromLogger(this),this.invalidateAppenderCache()},this.removeAllAppenders=function(){var a=b.length;if(a>0){for(var c=0;a>c;c++)b[c].setRemovedFromLogger(this);b.length=0,this.invalidateAppenderCache()}},this.getEffectiveAppenders=function(){if(null===f||g){var a=d||!this.getAdditivity()?[]:this.parent.getEffectiveAppenders();f=a.concat(b),g=!1}return f},this.invalidateAppenderCache=function(){g=!0;for(var a=0,b=this.children.length;b>a;a++)this.children[a].invalidateAppenderCache()},this.log=function(a,b){if(enabled&&a.isGreaterOrEqual(this.getEffectiveLevel())){var c,d=b.length-1,e=b[d];b.length>1&&e instanceof Error&&(c=e,d--);for(var f=[],g=0;d>=g;g++)f[g]=b[g];var h=new LoggingEvent(this,new Date,a,f,c);this.callAppenders(h)}},this.callAppenders=function(a){for(var b=this.getEffectiveAppenders(),c=0,d=b.length;d>c;c++)b[c].doAppend(a)},this.setLevel=function(a){d&&null===a?handleError("Logger.setLevel: you cannot set the level of the root logger to null"):a instanceof Level?c=a:handleError("Logger.setLevel: level supplied to logger "+this.name+" is not an instance of log4javascript.Level")},this.getLevel=function(){return c},this.getEffectiveLevel=function(){for(var a,b=this;null!==b&&(a=b.getLevel(),null===a);b=b.parent);return a},this.group=function(a,b){if(enabled)for(var c=this.getEffectiveAppenders(),d=0,e=c.length;e>d;d++)c[d].group(a,b)},this.groupEnd=function(){if(enabled)for(var a=this.getEffectiveAppenders(),b=0,c=a.length;c>b;b++)a[b].groupEnd()};var i={};this.time=function(a,b){enabled&&(isUndefined(a)?handleError("Logger.time: a name for the timer must be supplied"):!b||b instanceof Level?i[a]=new Timer(a,b):handleError("Logger.time: level supplied to timer "+a+" is not an instance of log4javascript.Level"))},this.timeEnd=function(a){if(enabled)if(isUndefined(a))handleError("Logger.timeEnd: a name for the timer must be supplied");else if(i[a]){var b=i[a],c=b.getElapsedTime();this.log(b.level,["Timer "+toStr(a)+" completed in "+c+"ms"]),delete i[a]}else logLog.warn("Logger.timeEnd: no timer found with name "+a)},this.assert=function(a){if(enabled&&!a){for(var b=[],c=1,d=arguments.length;d>c;c++)b.push(arguments[c]);b=b.length>0?b:["Assertion Failure"],b.push(newLine),b.push(a),this.log(Level.ERROR,b)}},this.toString=function(){return"Logger["+this.name+"]"}}function EventSupport(){this.eventTypes=[],this.eventListeners={}}function LogLog(){this.quietMode=!1,this.debugMessages=[],this.numberOfErrors=0,this.alertAllErrors=!1}function Timer(a,b){this.name=a,this.level=isUndefined(b)?Level.INFO:b,this.start=new Date}function Log4JavaScript(){this.version="1.4.6",this.edition="log4javascript_production"}function Layout(){}function HttpPostDataLayout(){this.setKeys(),this.customFields=[],this.returnsPostData=!0}function NullLayout(){this.customFields=[]}function escapeNewLines(a){return a.replace(/\r\n|\r|\n/g,"\\r\\n")}function JsonLayout(a,b){this.readable=extractBooleanFromParam(a,!1),this.combineMessages=extractBooleanFromParam(b,!0),this.batchHeader=this.readable?"["+newLine:"[",this.batchFooter=this.readable?"]"+newLine:"]",this.batchSeparator=this.readable?","+newLine:",",this.setKeys(),this.colon=this.readable?": ":":",this.tab=this.readable?"	":"",this.lineBreak=this.readable?newLine:"",this.customFields=[]}function PatternLayout(a){this.pattern=a?a:PatternLayout.DEFAULT_CONVERSION_PATTERN,this.customFields=[]}function SimpleLayout(){this.customFields=[]}function XmlLayout(a){this.combineMessages=extractBooleanFromParam(a,!0),this.customFields=[]}function isHttpRequestSuccessful(a){return isUndefined(a.status)||0===a.status||a.status>=200&&a.status<300||1223===a.status}function AjaxAppender(a){function b(a){return z?(handleError('AjaxAppender: configuration option "'+a+'" may not be set after the appender has been initialized'),!1):!0}function c(){if(k&&enabled){y=!0;var a;if(m)w.length>0?(a=w.shift(),h(e(a),c)):(y=!1,l&&f());else{for(;a=w.shift();)h(e(a));y=!1,l&&f()}}}function d(){var a=!1;if(k&&enabled){for(var b,d=j.getLayout().allowBatching()?n:1,e=[];b=v.shift();)e.push(b),v.length>=d&&(w.push(e),e=[]);e.length>0&&w.push(e),a=w.length>0,m=!1,l=!1,c()}return a}function e(a){for(var b,c=[],d="";b=a.shift();){var e=j.getLayout().format(b);j.getLayout().ignoresThrowable()&&(e+=b.getThrowableStrRep()),c.push(e)}return d=1===a.length?c.join(""):j.getLayout().batchHeader+c.join(j.getLayout().batchSeparator)+j.getLayout().batchFooter,t===j.defaults.contentType&&(d=j.getLayout().returnsPostData?d:urlEncode(r)+"="+urlEncode(d),d.length>0&&(d+="&"),d+="layout="+urlEncode(j.getLayout().toString())),d}function f(){window.setTimeout(c,o)}function g(){var a="AjaxAppender: could not create XMLHttpRequest object. AjaxAppender disabled";handleError(a),k=!1,q&&q(a)}function h(b,c){try{var d=getXmlHttp(g);if(k){d.overrideMimeType&&d.overrideMimeType(j.getLayout().getContentType()),d.onreadystatechange=function(){if(4===d.readyState){if(isHttpRequestSuccessful(d))p&&p(d),c&&c(d);else{var b="AjaxAppender.append: XMLHttpRequest request to URL "+a+" returned status code "+d.status;handleError(b),q&&q(b)}d.onreadystatechange=emptyFunction,d=null}},d.open("POST",a,!0);try{for(var e=0,f=x.length;f>e;e++){var h=x[e++];d.setRequestHeader(h.name,h.value)}d.setRequestHeader("Content-Type",t)}catch(i){var l="AjaxAppender.append: your browser's XMLHttpRequest implementation does not support setRequestHeader, therefore cannot post data. AjaxAppender disabled";return handleError(l),k=!1,q&&q(l),void 0}d.send(b)}}catch(m){var n="AjaxAppender.append: error sending log message to "+a;handleError(n,m),k=!1,q&&q(n+". Details: "+getExceptionStringRep(m))}}function i(){if(z=!0,s){var a=window.onbeforeunload;window.onbeforeunload=function(){return a&&a(),d()?"Sending log messages":void 0}}l&&f()}var j=this,k=!0;a||(handleError("AjaxAppender: URL must be specified in constructor"),k=!1);var l=this.defaults.timed,m=this.defaults.waitForResponse,n=this.defaults.batchSize,o=this.defaults.timerInterval,p=this.defaults.requestSuccessCallback,q=this.defaults.failCallback,r=this.defaults.postVarName,s=this.defaults.sendAllOnUnload,t=this.defaults.contentType,u=null,v=[],w=[],x=[],y=!1,z=!1;this.getSessionId=function(){return u},this.setSessionId=function(a){u=extractStringFromParam(a,null),this.layout.setCustomField("sessionid",u)},this.setLayout=function(a){b("layout")&&(this.layout=a,null!==u&&this.setSessionId(u))},this.isTimed=function(){return l},this.setTimed=function(a){b("timed")&&(l=toBool(a))},this.getTimerInterval=function(){return o},this.setTimerInterval=function(a){b("timerInterval")&&(o=extractIntFromParam(a,o))},this.isWaitForResponse=function(){return m},this.setWaitForResponse=function(a){b("waitForResponse")&&(m=toBool(a))},this.getBatchSize=function(){return n},this.setBatchSize=function(a){b("batchSize")&&(n=extractIntFromParam(a,n))},this.isSendAllOnUnload=function(){return s},this.setSendAllOnUnload=function(a){b("sendAllOnUnload")&&(s=extractBooleanFromParam(a,s))},this.setRequestSuccessCallback=function(a){p=extractFunctionFromParam(a,p)},this.setFailCallback=function(a){q=extractFunctionFromParam(a,q)},this.getPostVarName=function(){return r},this.setPostVarName=function(a){b("postVarName")&&(r=extractStringFromParam(a,r))},this.getHeaders=function(){return x},this.addHeader=function(a,b){"content-type"===a.toLowerCase()?t=b:x.push({name:a,value:b})},this.sendAll=c,this.sendAllRemaining=d,this.append=function(a){if(k){z||i(),v.push(a);var b=this.getLayout().allowBatching()?n:1;if(v.length>=b){for(var d,e=[];d=v.shift();)e.push(d);w.push(e),l||m&&(!m||y)||c()}}}}function AlertAppender(){}function BrowserConsoleAppender(){}function ConsoleAppender(){}function PopUpAppender(a,b,c,d,e){this.create(!1,null,a,b,c,d,e,this.defaults.focusPopUp)}function InPageAppender(a,b,c,d,e,f){this.create(!0,a,b,c,d,e,f,!1)}function setCookie(a,b,c,d){var e;if(d=d?"; path="+d:"",c){var f=new Date;f.setTime(f.getTime()+24*c*60*60*1e3),e="; expires="+f.toGMTString()}else e="";document.cookie=window.escape(a)+"="+window.escape(b)+e+d}function getCookie(a){for(var b=window.escape(a)+"=",c=document.cookie.split(";"),d=0,e=c.length;e>d;d++){for(var f=c[d];" "===f.charAt(0);)f=f.substring(1,f.length);if(0===f.indexOf(b))return window.unescape(f.substring(b.length,f.length))}return null}function getBaseUrl(){for(var a=document.getElementsByTagName("script"),b=0,c=a.length;c>b;++b)if(-1!==a[b].src.indexOf("log4javascript")){var d=a[b].src.lastIndexOf("/");return-1===d?"":a[b].src.substr(0,d+1)}return null}function isLoaded(a){try{return toBool(a.loaded)}catch(b){return!1}}function padWithSpaces(a,b){if(a.length<b){for(var c=[],d=Math.max(0,b-a.length),e=0;d>e;e++)c[e]=" ";a+=c.join("")}return a}function dir(a){var b=0;for(var c in a)b=Math.max(toStr(c).length,b);var d=[];for(c in a){var e,f="  "+padWithSpaces(toStr(c),b+2);try{e=splitIntoLines(toStr(a[c])).join(padWithSpaces(newLine,b+6))}catch(g){e="[Error obtaining property. Details: "+getExceptionMessage(g)+"]"}d.push(f+e)}return d.join(newLine)}function getXhtml(a,b,c,d,e){function f(a){return a.nodeType===nodeTypes.TEXT_NODE&&/^[ \t\r\n]*$/.test(a.nodeValue)}function g(a){return a.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/'/g,"&quot;")}function h(a){for(var b=a.style.cssText.split(";"),c="",d=0,e=b.length;e>d;d++){var f=b[d].split(":"),g=[];/^\s*$/.test(f[0])||g.push(trim(f[0]).toLowerCase()+":"+trim(f[1])),c=g.join(";")}return c}function i(a){if(a.prefix)return a.prefix;if(a.outerHTML){var b=new RegExp("<([^:]+):"+a.tagName+"[^>]*>","i");if(b.test(a.outerHTML))return RegExp.$1.toLowerCase()}return""}b=isUndefined(b)?!0:!!b,isString(c)&&(c=""),d=!!d,e=!!e;var j,k="<",l=">";if(!b||a.nodeType===nodeTypes.DOCUMENT_FRAGMENT_NODE){j="";for(var m=0,n=a.childNodes.length;n>m;m++)j+=getXhtml(a.childNodes[m],!0,c+indentationUnit);return j}switch(a.nodeType){case nodeTypes.ELEMENT_NODE:var o=a.tagName.toLowerCase();j=d?newLine+c:"",j+=k;var p=i(a),q=!!p;q&&(j+=p+":"),j+=o;for(var r=0,s=a.attributes.length;s>r;r++){var t=a.attributes[r];t.specified&&null!==t.nodeValue&&"style"!==t.nodeName.toLowerCase()&&"string"==typeof t.nodeValue&&0!==t.nodeName.indexOf("_moz")&&(j+=" "+t.nodeName.toLowerCase()+'="',j+=g(t.nodeValue),j+='"')}if(a.style.cssText){var u=h(a);""!==u&&(j+=' style="'+h(a)+'"')}if(arrayContains(emptyElements,o)||q&&!a.hasChildNodes())j+="/"+l;else{j+=l;for(var v=!(1===a.childNodes.length&&a.childNodes[0].nodeType===nodeTypes.TEXT_NODE),w=arrayContains(preFormattedElements,o),x=0,y=a.childNodes.length;y>x;x++)j+=getXhtml(a.childNodes[x],!0,c+indentationUnit,v,w);var z=k+"/"+o+l;j+=v?newLine+c+z:z}return j;case nodeTypes.TEXT_NODE:if(f(a))j="";else{if(e)j=a.nodeValue;else{for(var A=splitIntoLines(trim(a.nodeValue)),B=[],C=0,D=A.length;D>C;C++)B[C]=trim(A[C]);j=B.join(newLine+c)}d&&(j=newLine+c+j)}return j;case nodeTypes.CDATA_SECTION_NODE:return"<![CDATA["+a.nodeValue+"]]>"+newLine;case nodeTypes.DOCUMENT_NODE:j="";for(var E=0,F=a.childNodes.length;F>E;E++)j+=getXhtml(a.childNodes[E],!0,c);return j;default:return""}}function createCommandLineFunctions(){ConsoleAppender.addGlobalCommandLineFunction("$",function(a,b){return document.getElementById(b[0])}),ConsoleAppender.addGlobalCommandLineFunction("dir",function(a,b){for(var c=[],d=0,e=b.length;e>d;d++)c[d]=dir(b[d]);return c.join(newLine+newLine)}),ConsoleAppender.addGlobalCommandLineFunction("dirxml",function(a,b){for(var c=[],d=0,e=b.length;e>d;d++){{a.getCommandWindow()}c[d]=getXhtml(b[d])}return c.join(newLine+newLine)}),ConsoleAppender.addGlobalCommandLineFunction("cd",function(a,b,c){var d,e;return 0===b.length||""===b[0]?(d=window,e="Command line set to run in main window"):b[0].window===b[0]?(d=b[0],e='Command line set to run in frame "'+b[0].name+'"'):(d=window.frames[b[0]],d?e='Command line set to run in frame "'+b[0]+'"':(c.isError=!0,e='Frame "'+b[0]+'" does not exist',d=a.getCommandWindow())),a.setCommandWindow(d),e}),ConsoleAppender.addGlobalCommandLineFunction("clear",function(a,b,c){c.appendResult=!1,a.clear()}),ConsoleAppender.addGlobalCommandLineFunction("keys",function(a,b){var c=[];for(var d in b[0])c.push(d);return c}),ConsoleAppender.addGlobalCommandLineFunction("values",function(a,b){var c=[];for(var d in b[0])try{c.push(b[0][d])}catch(e){logLog.warn("values(): Unable to obtain value for key "+d+". Details: "+getExceptionMessage(e))}return c}),ConsoleAppender.addGlobalCommandLineFunction("expansionDepth",function(a,b,c){var d=parseInt(b[0],10);return isNaN(d)||0>d?(c.isError=!0,""+b[0]+" is not a valid expansion depth"):(a.setCommandLineObjectExpansionDepth(d),"Object expansion depth set to "+d)})}function init(){createCommandLineFunctions()}var logLog,uniqueId,ROOT_LOGGER_DEFAULT_LEVEL,enabled=!0,showStackTraces=!1,applicationStartDate=new Date,emptyFunction=function(){},newLine="\r\n",pageLoaded=!1,loggers={},loggerNames=[],SimpleDateFormat;!function(){var a=/('[^']*')|(G+|y+|M+|w+|W+|D+|d+|F+|E+|a+|H+|k+|K+|h+|m+|s+|S+|Z+)|([a-zA-Z]+)|([^a-zA-Z']+)/,b=["January","February","March","April","May","June","July","August","September","October","November","December"],c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d=0,e=1,f=2,g=3,h=4,i=5,j={G:d,y:g,M:h,w:f,W:f,D:f,d:f,F:f,E:e,a:d,H:f,k:f,K:f,h:f,m:f,s:f,S:f,Z:i},k=864e5,l=7*k,m=1,n=function(a,b,c){var d=new Date(a,b,c,0,0,0);return d.setMilliseconds(0),d};Date.prototype.getDifference=function(a){return this.getTime()-a.getTime()},Date.prototype.isBefore=function(a){return this.getTime()<a.getTime()},Date.prototype.getUTCTime=function(){return Date.UTC(this.getFullYear(),this.getMonth(),this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())},Date.prototype.getTimeSince=function(a){return this.getUTCTime()-a.getUTCTime()},Date.prototype.getPreviousSunday=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),12,0,0),b=new Date(a.getTime()-this.getDay()*k);return n(b.getFullYear(),b.getMonth(),b.getDate())},Date.prototype.getWeekInYear=function(a){isUndefined(this.minimalDaysInFirstWeek)&&(a=m);var b=this.getPreviousSunday(),c=n(this.getFullYear(),0,1),d=b.isBefore(c)?0:1+Math.floor(b.getTimeSince(c)/l),e=7-c.getDay(),f=d;return a>e&&f--,f},Date.prototype.getWeekInMonth=function(a){isUndefined(this.minimalDaysInFirstWeek)&&(a=m);var b=this.getPreviousSunday(),c=n(this.getFullYear(),this.getMonth(),1),d=b.isBefore(c)?0:1+Math.floor(b.getTimeSince(c)/l),e=7-c.getDay(),f=d;return e>=a&&f++,f},Date.prototype.getDayInYear=function(){var a=n(this.getFullYear(),0,1);return 1+Math.floor(this.getTimeSince(a)/k)},SimpleDateFormat=function(a){this.formatString=a},SimpleDateFormat.prototype.setMinimalDaysInFirstWeek=function(a){this.minimalDaysInFirstWeek=a},SimpleDateFormat.prototype.getMinimalDaysInFirstWeek=function(){return isUndefined(this.minimalDaysInFirstWeek)?m:this.minimalDaysInFirstWeek};var o=function(a,b){for(;a.length<b;)a="0"+a;return a},p=function(a,b,c){return b>=4?a:a.substr(0,Math.max(c,b))},q=function(a,b){var c=""+a;return o(c,b)};SimpleDateFormat.prototype.format=function(k){for(var l,m="",n=this.formatString;l=a.exec(n);){var r=l[1],s=l[2],t=l[3],u=l[4];if(r)m+="''"===r?"'":r.substring(1,r.length-1);else if(t);else if(u)m+=u;else if(s){var v=s.charAt(0),w=s.length,x="";switch(v){case"G":x="AD";break;case"y":x=k.getFullYear();break;case"M":x=k.getMonth();break;case"w":x=k.getWeekInYear(this.getMinimalDaysInFirstWeek());break;case"W":x=k.getWeekInMonth(this.getMinimalDaysInFirstWeek());break;case"D":x=k.getDayInYear();break;case"d":x=k.getDate();break;case"F":x=1+Math.floor((k.getDate()-1)/7);break;case"E":x=c[k.getDay()];break;case"a":x=k.getHours()>=12?"PM":"AM";break;case"H":x=k.getHours();break;case"k":x=k.getHours()||24;break;case"K":x=k.getHours()%12;break;case"h":x=k.getHours()%12||12;break;case"m":x=k.getMinutes();break;case"s":x=k.getSeconds();break;case"S":x=k.getMilliseconds();break;case"Z":x=k.getTimezoneOffset()}switch(j[v]){case d:m+=p(x,w,2);break;case e:m+=p(x,w,3);break;case f:m+=q(x,w);break;case g:if(3>=w){var y=""+x;m+=y.substr(2,2)}else m+=q(x,w);break;case h:m+=w>=3?p(b[x],w,w):q(x+1,w);break;case i:var z=x>0,A=z?"-":"+",B=Math.abs(x),C=""+Math.floor(B/60);C=o(C,2);var D=""+B%60;D=o(D,2),m+=A+C+D}}n=n.substr(l.index+l[0].length)}return m}}(),"undefined"!=typeof log4javascript&&(log4javascript.SimpleDateFormat=SimpleDateFormat),Level.prototype.toString=function(){return this.name},Level.prototype.equals=function(a){return this.level===a.level},Level.prototype.isGreaterOrEqual=function(a){return this.level>=a.level},Level.ALL=new Level(Number.MIN_VALUE,"ALL"),Level.TRACE=new Level(1e4,"TRACE"),Level.DEBUG=new Level(2e4,"DEBUG"),Level.INFO=new Level(3e4,"INFO"),Level.WARN=new Level(4e4,"WARN"),Level.ERROR=new Level(5e4,"ERROR"),Level.FATAL=new Level(6e4,"FATAL"),Level.OFF=new Level(Number.MAX_VALUE,"OFF"),ROOT_LOGGER_DEFAULT_LEVEL=Level.DEBUG;var LoggingEvent=function(a,b,c,d,e){this.logger=a,this.timeStamp=b,this.timeStampInMilliseconds=b.getTime(),this.timeStampInSeconds=Math.floor(this.timeStampInMilliseconds/1e3),this.milliseconds=this.timeStamp.getMilliseconds(),this.level=c,this.messages=d,this.exception=e};LoggingEvent.prototype.getThrowableStrRep=function(){return this.exception?getExceptionStringRep(this.exception):""},LoggingEvent.prototype.getCombinedMessages=function(){return 1===this.messages.length?this.messages[0]:this.messages.join(newLine)},LoggingEvent.prototype.toString=function(){return"LoggingEvent["+this.level+"]"};var anonymousLoggerName="[anonymous]",defaultLoggerName="[default]",nullLoggerName="[null]",rootLoggerName="root";Logger.prototype.trace=function(){this.log(Level.TRACE,arguments)},Logger.prototype.debug=function(){this.log(Level.DEBUG,arguments)},Logger.prototype.info=function(){this.log(Level.INFO,arguments)},Logger.prototype.warn=function(){this.log(Level.WARN,arguments)},Logger.prototype.error=function(){this.log(Level.ERROR,arguments)},Logger.prototype.fatal=function(){this.log(Level.FATAL,arguments)},Logger.prototype.isEnabledFor=function(a){return a.isGreaterOrEqual(this.getEffectiveLevel())},Logger.prototype.isTraceEnabled=function(){return this.isEnabledFor(Level.TRACE)},Logger.prototype.isDebugEnabled=function(){return this.isEnabledFor(Level.DEBUG)},Logger.prototype.isInfoEnabled=function(){return this.isEnabledFor(Level.INFO)},Logger.prototype.isWarnEnabled=function(){return this.isEnabledFor(Level.WARN)},Logger.prototype.isErrorEnabled=function(){return this.isEnabledFor(Level.ERROR)},Logger.prototype.isFatalEnabled=function(){return this.isEnabledFor(Level.FATAL)},Logger.prototype.trace.isEntryPoint=!0,Logger.prototype.debug.isEntryPoint=!0,Logger.prototype.info.isEntryPoint=!0,Logger.prototype.warn.isEntryPoint=!0,Logger.prototype.error.isEntryPoint=!0,Logger.prototype.fatal.isEntryPoint=!0,EventSupport.prototype.setEventTypes=function(a){if(isArray(a)){this.eventTypes=a,this.eventListeners={};for(var b=0,c=this.eventTypes.length;c>b;b++)this.eventListeners[this.eventTypes[b]]=[]}else handleError("EventSupport ["+this+"]: setEventTypes: eventTypes parameter must be an Array")},EventSupport.prototype.addEventListener=function(a,b){isFunction(b)?arrayContains(this.eventTypes,a)?this.eventListeners[a].push(b):handleError("EventSupport ["+this+']: addEventListener: no event called "'+a+'"'):handleError("EventSupport ["+this+"]: addEventListener: listener must be a function")},EventSupport.prototype.removeEventListener=function(a,b){isFunction(b)?arrayContains(this.eventTypes,a)?arrayRemove(this.eventListeners[a],b):handleError("EventSupport ["+this+']: removeEventListener: no event called "'+a+'"'):handleError("EventSupport ["+this+"]: removeEventListener: listener must be a function")},EventSupport.prototype.dispatchEvent=function(a,b){if(arrayContains(this.eventTypes,a))for(var c=this.eventListeners[a],d=0,e=c.length;e>d;d++)c[d](this,a,b);else handleError("EventSupport ["+this+']: dispatchEvent: no event called "'+a+'"')},uniqueId="log4javascript_"+getUUID(),LogLog.prototype.setQuietMode=function(a){this.quietMode=toBool(a)},LogLog.prototype.setAlertAllErrors=function(a){this.alertAllErrors=a},LogLog.prototype.debug=function(a){this.debugMessages.push(a)},LogLog.prototype.displayDebug=function(){alert(this.debugMessages.join(newLine))},LogLog.prototype.warn=function(){},LogLog.prototype.error=function(a,b){if((1===++this.numberOfErrors||this.alertAllErrors)&&!this.quietMode){var c="log4javascript error: "+a;b&&(c+=newLine+newLine+"Original error: "+getExceptionStringRep(b)),alert(c)}},logLog=new LogLog,Timer.prototype.getElapsedTime=function(){return(new Date).getTime()-this.start.getTime()};var rootLogger=new Logger(rootLoggerName);rootLogger.setLevel(ROOT_LOGGER_DEFAULT_LEVEL),Log4JavaScript.prototype=new EventSupport,Log4JavaScript.prototype.logLog=logLog,Log4JavaScript.prototype.setEnabled=function(a){enabled=toBool(a)},Log4JavaScript.prototype.isEnabled=function(){return enabled},Log4JavaScript.prototype.useTimeStampsInMilliseconds=!0,Log4JavaScript.prototype.setTimeStampsInMilliseconds=function(a){this.useTimeStampsInMilliseconds=toBool(a)},Log4JavaScript.prototype.isTimeStampsInMilliseconds=function(){return this.useTimeStampsInMilliseconds},Log4JavaScript.prototype.evalInScope=function(expr){return eval(expr)},Log4JavaScript.prototype.setShowStackTraces=function(a){showStackTraces=toBool(a)},Log4JavaScript.prototype.getRootLogger=function(){return rootLogger},Log4JavaScript.prototype.getLogger=function(a){if(isString(a)||(a=anonymousLoggerName,logLog.warn("log4javascript.getLogger: non-string logger name "+toStr(a)+" supplied, returning anonymous logger")),a===rootLoggerName&&handleError("log4javascript.getLogger: root logger may not be obtained by name"),!loggers[a]){var b=new Logger(a);loggers[a]=b,loggerNames.push(a);var c,d=a.lastIndexOf(".");if(d>-1){var e=a.substring(0,d);c=log4javascript.getLogger(e)}else c=rootLogger;c.addChild(b)}return loggers[a]};var defaultLogger=null;Log4JavaScript.prototype.getDefaultLogger=function(){if(!defaultLogger){defaultLogger=log4javascript.getLogger(defaultLoggerName);var a=new log4javascript.PopUpAppender;defaultLogger.addAppender(a)}return defaultLogger};var nullLogger=null;Log4JavaScript.prototype.getNullLogger=function(){return nullLogger||(nullLogger=new Logger(nullLoggerName),nullLogger.setLevel(Level.OFF)),nullLogger},Log4JavaScript.prototype.resetConfiguration=function(){rootLogger.setLevel(ROOT_LOGGER_DEFAULT_LEVEL),loggers={}},Log4JavaScript.prototype.setDocumentReady=function(){pageLoaded=!0,log4javascript.dispatchEvent("load",{})},Log4JavaScript.prototype.Level=Level;var log4javascript=new Log4JavaScript;if(log4javascript.setEventTypes(["load","error"]),log4javascript.LoggingEvent=LoggingEvent,window.addEventListener)window.addEventListener("load",log4javascript.setDocumentReady,!1);else if(window.attachEvent)window.attachEvent("onload",log4javascript.setDocumentReady);else{var oldOnload=window.onload;window.onload="function"!=typeof window.onload?log4javascript.setDocumentReady:function(a){oldOnload&&oldOnload(a),log4javascript.setDocumentReady()}}Layout.prototype.defaults={loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url"},Layout.prototype.loggerKey="logger",Layout.prototype.timeStampKey="timestamp",Layout.prototype.millisecondsKey="milliseconds",Layout.prototype.levelKey="level",Layout.prototype.messageKey="message",Layout.prototype.exceptionKey="exception",Layout.prototype.urlKey="url",Layout.prototype.batchHeader="",Layout.prototype.batchFooter="",Layout.prototype.batchSeparator="",Layout.prototype.returnsPostData=!1,Layout.prototype.overrideTimeStampsSetting=!1,Layout.prototype.useTimeStampsInMilliseconds=null,Layout.prototype.customFields=[],Layout.prototype.format=function(){handleError("Layout.format: layout supplied has no format() method")},Layout.prototype.ignoresThrowable=function(){handleError("Layout.ignoresThrowable = layout supplied has no ignoresThrowable() method")},Layout.prototype.getContentType=function(){return"text/plain"},Layout.prototype.allowBatching=function(){return!0},Layout.prototype.setTimeStampsInMilliseconds=function(a){this.overrideTimeStampsSetting=!0,this.useTimeStampsInMilliseconds=toBool(a)},Layout.prototype.isTimeStampsInMilliseconds=function(){return this.overrideTimeStampsSetting?this.useTimeStampsInMilliseconds:this.useTimeStampsInMilliseconds},Layout.prototype.getTimeStampValue=function(a){return this.isTimeStampsInMilliseconds()?a.timeStampInMilliseconds:a.timeStampInSeconds},Layout.prototype.getDataValues=function(a,b){var c=[[this.loggerKey,a.logger.name],[this.timeStampKey,this.getTimeStampValue(a)],[this.levelKey,a.level.name],[this.urlKey,window.location.href],[this.messageKey,b?a.getCombinedMessages():a.messages]];if(this.isTimeStampsInMilliseconds()||c.push([this.millisecondsKey,a.milliseconds]),a.exception&&c.push([this.exceptionKey,getExceptionStringRep(a.exception)]),this.hasCustomFields())for(var d=0,e=this.customFields.length;e>d;d++){var f=this.customFields[d].value;"function"==typeof f&&(f=f(this,a)),c.push([this.customFields[d].name,f])}return c},Layout.prototype.setKeys=function(a,b,c,d,e,f,g){this.loggerKey=extractStringFromParam(a,this.defaults.loggerKey),this.timeStampKey=extractStringFromParam(b,this.defaults.timeStampKey),this.levelKey=extractStringFromParam(c,this.defaults.levelKey),this.messageKey=extractStringFromParam(d,this.defaults.messageKey),this.exceptionKey=extractStringFromParam(e,this.defaults.exceptionKey),this.urlKey=extractStringFromParam(f,this.defaults.urlKey),this.millisecondsKey=extractStringFromParam(g,this.defaults.millisecondsKey)},Layout.prototype.setCustomField=function(a,b){if("undefined"==typeof a||"undefined"==typeof b)handleError("layout.setCustomFields: name and value must be defined");else if(isString(a)){for(var c=!1,d=0,e=this.customFields.length;e>d;d++)this.customFields[d].name===a&&(this.customFields[d].value=b,c=!0);c||this.customFields.push({name:a,value:b})}else handleError('layout.setCustomFields: name must be "String"')},Layout.prototype.hasCustomFields=function(){return this.customFields.length>0},Layout.prototype.toString=function(){handleError("Layout.toString: all layouts must override this method")},"undefined"!=typeof log4javascript&&(log4javascript.Layout=Layout),HttpPostDataLayout.prototype=new Layout,HttpPostDataLayout.prototype.allowBatching=function(){return!1},HttpPostDataLayout.prototype.format=function(a){for(var b=this.getDataValues(a),c=[],d=0,e=b.length;e>d;d++){var f=b[d][1]instanceof Date?String(b[d][1].getTime()):b[d][1];c.push(urlEncode(b[d][0])+"="+urlEncode(f))}return c.join("&")},HttpPostDataLayout.prototype.ignoresThrowable=function(){return!1},HttpPostDataLayout.prototype.toString=function(){return"HttpPostDataLayout"
},"undefined"!=typeof log4javascript&&(log4javascript.HttpPostDataLayout=HttpPostDataLayout),NullLayout.prototype=new Layout,NullLayout.prototype.format=function(a){return a.messages},NullLayout.prototype.ignoresThrowable=function(){return!0},NullLayout.prototype.toString=function(){return"NullLayout"},"undefined"!=typeof log4javascript&&(log4javascript.NullLayout=NullLayout),JsonLayout.prototype=new Layout,JsonLayout.prototype.isReadable=function(){return this.readable},JsonLayout.prototype.isCombinedMessages=function(){return this.combineMessages},JsonLayout.prototype.format=function(a){function b(a,c,d){var f,g=typeof a;if(a instanceof Date)f=String(a.getTime());else if(d&&a instanceof Array){f="["+e.lineBreak;for(var h=0,i=a.length;i>h;h++){var j=c+e.tab;f+=j+b(a[h],j,!1),h<a.length-1&&(f+=","),f+=e.lineBreak}f+=c+"]"}else f="number"!==g&&"boolean"!==g?'"'+escapeNewLines(toStr(a).replace(/\'/g,'\\"'))+'"':a;return f}var c,d,e=this,f=this.getDataValues(a,this.combineMessages),g="{"+this.lineBreak;for(c=0,d=f.length-1;d>=c;c++)g+=this.tab+'"'+f[c][0]+'"'+this.colon+b(f[c][1],this.tab,!0),d>c&&(g+=","),g+=this.lineBreak;return g+="}"+this.lineBreak},JsonLayout.prototype.ignoresThrowable=function(){return!1},JsonLayout.prototype.toString=function(){return"JsonLayout"},JsonLayout.prototype.getContentType=function(){return"application/json"},"undefined"!=typeof log4javascript&&(log4javascript.JsonLayout=JsonLayout),PatternLayout.TTCC_CONVERSION_PATTERN="%r %p %c - %m%n",PatternLayout.DEFAULT_CONVERSION_PATTERN="%m%n",PatternLayout.ISO8601_DATEFORMAT="yyyy-MM-dd HH:mm:ss,SSS",PatternLayout.DATETIME_DATEFORMAT="dd MMM yyyy HH:mm:ss,SSS",PatternLayout.ABSOLUTETIME_DATEFORMAT="HH:mm:ss,SSS",PatternLayout.prototype=new Layout,PatternLayout.prototype.format=function(a){for(var b,c=/%(-?[0-9]+)?(\.?[0-9]+)?([acdflmMnpr%])(\{([^\}]+)\})?|([^%]+)/,d="",e=this.pattern;b=c.exec(e);){var f=b[0],g=b[1],h=b[2],i=b[3],j=b[5],k=b[6];if(k)d+=""+k;else{var l="";switch(i){case"l":var m=new Error;if(m.stack){var n,o,p,q,r,s=m.stack,t=s.split("\n")[8];if(""===t){var u=s.lastIndexOf("@");t=s.substr(u),q=0,r=t.indexOf("@")+1}else q=t.indexOf("at ")+3,r=t.indexOf(" (")+2;var v,w=r>q?t.substring(q,r-2):null;w?v=t.substring(r,t.length-1):(w="(anonymous)",v=t.substring(q));var x=v.split(":");n=x.pop(),o=x.pop(),isNaN(o)?(x.push(o),p=x.join(":"),0===p.indexOf("@")&&(p=p.substr(1)),o=n,n=0/0):p=x.join(":");var y=p.lastIndexOf("/"),z=p.substring(y+1),A="s:l";j&&(A=j);var B,C=[],D="";for(B=0;B<A.length;B++){var E=A[B],F=parseInt(E,10);F>-1?D+=E:(D.length>0&&(C.push(parseInt(D,10)),D=""),C.push(E))}for(D.length>0&&C.push(parseInt(D,10)),A=C,B=0;B<A.length;B++){var G=A[B+1],H="";switch(A[B]){case"s":l+=z;break;case"r":H=p,"number"==typeof G&&(H=H.substring(H.length-G),A.splice(B+1,1)),l+=H;break;case"l":l+=o;break;case"c":isNaN(n)?l=l.substring(0,l.lastIndexOf(A[B-1])):l+=n;break;case"f":H=w,"number"==typeof G&&(H=H.substring(H.length-G),A.splice(B+1,1)),l+=H;break;default:l+=A[B]}}}else handleError('Could not apply "l" pattern because no stack is available');break;case"a":case"m":var I=0;j&&(I=parseInt(j,10),isNaN(I)&&(handleError('PatternLayout.format: invalid specifier "'+j+'" for conversion character "'+i+'" - should be a number'),I=0));for(var J="a"===i?a.messages[0]:a.messages,K=0,L=J.length;L>K;K++)K>0&&" "!==l.charAt(l.length-1)&&(l+=" "),l+=0===I?J[K]:formatObjectExpansion(J[K],I);break;case"c":var M=a.logger.name;if(j){var N=parseInt(j,10),O=a.logger.name.split(".");l=N>=O.length?M:O.slice(O.length-N).join(".")}else l=M;break;case"d":var P=PatternLayout.ISO8601_DATEFORMAT;j&&(P=j,"ISO8601"===P?P=PatternLayout.ISO8601_DATEFORMAT:"ABSOLUTE"===P?P=PatternLayout.ABSOLUTETIME_DATEFORMAT:"DATE"===P&&(P=PatternLayout.DATETIME_DATEFORMAT)),l=new SimpleDateFormat(P).format(a.timeStamp);break;case"f":if(this.hasCustomFields()){var Q=0;j&&(Q=parseInt(j,10),isNaN(Q)?handleError('PatternLayout.format: invalid specifier "'+j+'" for conversion character "f" - should be a number'):0===Q?handleError('PatternLayout.format: invalid specifier "'+j+'" for conversion character "f" - must be greater than zero'):Q>this.customFields.length?handleError('PatternLayout.format: invalid specifier "'+j+'" for conversion character "f" - there aren\'t that many custom fields'):Q-=1);var R=this.customFields[Q].value;"function"==typeof R&&(R=R(this,a)),l=R}break;case"n":l=newLine;break;case"p":l=a.level.name;break;case"r":l=""+a.timeStamp.getDifference(applicationStartDate);break;case"%":l="%";break;default:l=f}var S;if(h){S=parseInt(h.substr(1),10);var T=l.length;T>S&&(l=l.substring(T-S,T))}if(g)if("-"===g.charAt(0))for(S=parseInt(g.substr(1),10);l.length<S;)l+=" ";else for(S=parseInt(g,10);l.length<S;)l=" "+l;d+=l}e=e.substr(b.index+b[0].length)}return d},PatternLayout.prototype.ignoresThrowable=function(){return!0},PatternLayout.prototype.toString=function(){return"PatternLayout"},"undefined"!=typeof log4javascript&&(log4javascript.PatternLayout=PatternLayout),SimpleLayout.prototype=new Layout,SimpleLayout.prototype.format=function(a){return a.level.name+" - "+a.getCombinedMessages()},SimpleLayout.prototype.ignoresThrowable=function(){return!0},SimpleLayout.prototype.toString=function(){return"SimpleLayout"},"undefined"!=typeof log4javascript&&(log4javascript.SimpleLayout=SimpleLayout),XmlLayout.prototype=new Layout,XmlLayout.prototype.isCombinedMessages=function(){return this.combineMessages},XmlLayout.prototype.getContentType=function(){return"text/xml"},XmlLayout.prototype.escapeCdata=function(a){return a.replace(/\]\]>/,"]]>]]&gt;<![CDATA[")},XmlLayout.prototype.format=function(a){function b(a){return a="string"==typeof a?a:toStr(a),"<log4javascript:message><![CDATA["+e.escapeCdata(a)+"]]></log4javascript:message>"}var c,d,e=this,f='<log4javascript:event logger="'+a.logger.name+'" timestamp="'+this.getTimeStampValue(a)+'"';if(this.isTimeStampsInMilliseconds()||(f+=' milliseconds="'+a.milliseconds+'"'),f+=' level="'+a.level.name+'">'+newLine,this.combineMessages)f+=b(a.getCombinedMessages());else{for(f+="<log4javascript:messages>"+newLine,c=0,d=a.messages.length;d>c;c++)f+=b(a.messages[c])+newLine;f+="</log4javascript:messages>"+newLine}if(this.hasCustomFields())for(c=0,d=this.customFields.length;d>c;c++)f+='<log4javascript:customfield name="'+this.customFields[c].name+'"><![CDATA['+this.customFields[c].value.toString()+"]]></log4javascript:customfield>"+newLine;return a.exception&&(f+="<log4javascript:exception><![CDATA["+getExceptionStringRep(a.exception)+"]]></log4javascript:exception>"+newLine),f+="</log4javascript:event>"+newLine+newLine},XmlLayout.prototype.ignoresThrowable=function(){return!1},XmlLayout.prototype.toString=function(){return"XmlLayout"},log4javascript.XmlLayout=XmlLayout;var Appender=function(){};Appender.prototype=new EventSupport,Appender.prototype.layout=new PatternLayout,Appender.prototype.threshold=Level.ALL,Appender.prototype.loggers=[],Appender.prototype.doAppend=function(a){enabled&&a.level.level>=this.threshold.level&&this.append(a)},Appender.prototype.append=function(){},Appender.prototype.setLayout=function(a){a instanceof Layout?this.layout=a:handleError("Appender.setLayout: layout supplied to "+this.toString()+" is not a subclass of Layout")},Appender.prototype.getLayout=function(){return this.layout},Appender.prototype.setThreshold=function(a){a instanceof Level?this.threshold=a:handleError("Appender.setThreshold: threshold supplied to "+this.toString()+" is not a subclass of Level")},Appender.prototype.getThreshold=function(){return this.threshold},Appender.prototype.setAddedToLogger=function(a){this.loggers.push(a)},Appender.prototype.setRemovedFromLogger=function(a){arrayRemove(this.loggers,a)},Appender.prototype.group=emptyFunction,Appender.prototype.groupEnd=emptyFunction,Appender.prototype.toString=function(){handleError("Appender.toString: all appenders must override this method")},"undefined"!=typeof log4javascript&&(log4javascript.Appender=Appender);var xmlHttpFactories=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],getXmlHttp=function(a){for(var b,c=null,d=0,e=xmlHttpFactories.length;e>d;d++){b=xmlHttpFactories[d];try{c=b(),getXmlHttp=b;break}catch(f){}}return a?a():handleError("getXmlHttp: unable to obtain XMLHttpRequest object"),c};AjaxAppender.prototype=new Appender,AjaxAppender.prototype.defaults={waitForResponse:!1,timed:!1,timerInterval:1e3,batchSize:1,sendAllOnUnload:!1,requestSuccessCallback:null,failCallback:null,postVarName:"data",contentType:"application/x-www-form-urlencoded"},AjaxAppender.prototype.layout=new HttpPostDataLayout,AjaxAppender.prototype.toString=function(){return"AjaxAppender"},log4javascript.AjaxAppender=AjaxAppender,AlertAppender.prototype=new Appender,AlertAppender.prototype.layout=new SimpleLayout,AlertAppender.prototype.append=function(a){var b=this.getLayout().format(a);this.getLayout().ignoresThrowable()&&(b+=a.getThrowableStrRep()),alert(b)},AlertAppender.prototype.toString=function(){return"AlertAppender"},"undefined"!=typeof log4javascript&&(log4javascript.AlertAppender=AlertAppender),BrowserConsoleAppender.prototype=new Appender,BrowserConsoleAppender.prototype.layout=new NullLayout,BrowserConsoleAppender.prototype.threshold=Level.DEBUG,BrowserConsoleAppender.prototype.append=function(a){var b=this,c=function(){var c=b.getLayout(),d=c.format(a);return c.ignoresThrowable()&&a.exception&&(d+=a.getThrowableStrRep()),d};if("undefined"!=typeof opera&&opera.postError)opera.postError(c());else if(window.console&&window.console.log){var d=c();window.console.debug&&Level.DEBUG.isGreaterOrEqual(a.level)?window.console.debug(d):window.console.info&&Level.INFO.equals(a.level)?window.console.info(d):window.console.warn&&Level.WARN.equals(a.level)?window.console.warn(d):window.console.error&&a.level.isGreaterOrEqual(Level.ERROR)?window.console.error(d):window.console.log(d)}},BrowserConsoleAppender.prototype.group=function(a){window.console&&window.console.group&&window.console.group(a)},BrowserConsoleAppender.prototype.groupEnd=function(){window.console&&window.console.groupEnd&&window.console.groupEnd()},BrowserConsoleAppender.prototype.toString=function(){return"BrowserConsoleAppender"},log4javascript.BrowserConsoleAppender=BrowserConsoleAppender;var getConsoleHtmlLines=function(){return['<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">','<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">'," <head>","  <title>log4javascript</title>",'  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />',"  <!-- Make IE8 behave like IE7, having gone to all the trouble of making IE work -->",'  <meta http-equiv="X-UA-Compatible" content="IE=7" />','  <script type="text/javascript">var isIe = false, isIePre7 = false;</script>','  <!--[if IE]><script type="text/javascript">isIe = true</script><![endif]-->','  <!--[if lt IE 7]><script type="text/javascript">isIePre7 = true</script><![endif]-->','  <script type="text/javascript">',"   //<![CDATA[","   var loggingEnabled = true;","   var logQueuedEventsTimer = null;","   var logEntries = [];","   var logEntriesAndSeparators = [];","   var logItems = [];","   var renderDelay = 100;","   var unrenderedLogItemsExist = false;","   var rootGroup, currentGroup = null;","   var loaded = false;","   var currentLogItem = null;","   var logMainContainer;","","   function copyProperties(obj, props) {","    for (var i in props) {","     obj[i] = props[i];","    }","   }","","   /*----------------------------------------------------------------*/","","   function LogItem() {","   }","","   LogItem.prototype = {","    mainContainer: null,","    wrappedContainer: null,","    unwrappedContainer: null,","    group: null,","","    appendToLog: function() {","     for (var i = 0, len = this.elementContainers.length; i < len; i++) {","      this.elementContainers[i].appendToLog();","     }","     this.group.update();","    },","","    doRemove: function(doUpdate, removeFromGroup) {","     if (this.rendered) {","      for (var i = 0, len = this.elementContainers.length; i < len; i++) {","       this.elementContainers[i].remove();","      }","      this.unwrappedElementContainer = null;","      this.wrappedElementContainer = null;","      this.mainElementContainer = null;","     }","     if (this.group && removeFromGroup) {","      this.group.removeChild(this, doUpdate);","     }","     if (this === currentLogItem) {","      currentLogItem = null;","     }","    },","","    remove: function(doUpdate, removeFromGroup) {","     this.doRemove(doUpdate, removeFromGroup);","    },","","    render: function() {},","","    accept: function(visitor) {","     visitor.visit(this);","    },","","    getUnwrappedDomContainer: function() {","     return this.group.unwrappedElementContainer.contentDiv;","    },","","    getWrappedDomContainer: function() {","     return this.group.wrappedElementContainer.contentDiv;","    },","","    getMainDomContainer: function() {","     return this.group.mainElementContainer.contentDiv;","    }","   };","","   LogItem.serializedItemKeys = {LOG_ENTRY: 0, GROUP_START: 1, GROUP_END: 2};","","   /*----------------------------------------------------------------*/","","   function LogItemContainerElement() {","   }","","   LogItemContainerElement.prototype = {","    appendToLog: function() {","     var insertBeforeFirst = (newestAtTop && this.containerDomNode.hasChildNodes());","     if (insertBeforeFirst) {","      this.containerDomNode.insertBefore(this.mainDiv, this.containerDomNode.firstChild);","     } else {","      this.containerDomNode.appendChild(this.mainDiv);","     }","    }","   };","","   /*----------------------------------------------------------------*/","","   function SeparatorElementContainer(containerDomNode) {","    this.containerDomNode = containerDomNode;",'    this.mainDiv = document.createElement("div");','    this.mainDiv.className = "separator";','    this.mainDiv.innerHTML = "&nbsp;";',"   }","","   SeparatorElementContainer.prototype = new LogItemContainerElement();","","   SeparatorElementContainer.prototype.remove = function() {","    this.mainDiv.parentNode.removeChild(this.mainDiv);","    this.mainDiv = null;","   };","","   /*----------------------------------------------------------------*/","","   function Separator() {","    this.rendered = false;","   }","","   Separator.prototype = new LogItem();","","   copyProperties(Separator.prototype, {","    render: function() {","     var containerDomNode = this.group.contentDiv;","     if (isIe) {","      this.unwrappedElementContainer = new SeparatorElementContainer(this.getUnwrappedDomContainer());","      this.wrappedElementContainer = new SeparatorElementContainer(this.getWrappedDomContainer());","      this.elementContainers = [this.unwrappedElementContainer, this.wrappedElementContainer];","     } else {","      this.mainElementContainer = new SeparatorElementContainer(this.getMainDomContainer());","      this.elementContainers = [this.mainElementContainer];","     }","     this.content = this.formattedMessage;","     this.rendered = true;","    }","   });","","   /*----------------------------------------------------------------*/","","   function GroupElementContainer(group, containerDomNode, isRoot, isWrapped) {","    this.group = group;","    this.containerDomNode = containerDomNode;","    this.isRoot = isRoot;","    this.isWrapped = isWrapped;","    this.expandable = false;","","    if (this.isRoot) {","     if (isIe) {",'      this.contentDiv = logMainContainer.appendChild(document.createElement("div"));','      this.contentDiv.id = this.isWrapped ? "log_wrapped" : "log_unwrapped";',"     } else {","      this.contentDiv = logMainContainer;","     }","    } else {","     var groupElementContainer = this;","     ",'     this.mainDiv = document.createElement("div");','     this.mainDiv.className = "group";',"",'     this.headingDiv = this.mainDiv.appendChild(document.createElement("div"));','     this.headingDiv.className = "groupheading";',"",'     this.expander = this.headingDiv.appendChild(document.createElement("span"));','     this.expander.className = "expander unselectable greyedout";',"     this.expander.unselectable = true;",'     var expanderText = this.group.expanded ? "-" : "+";',"     this.expanderTextNode = this.expander.appendChild(document.createTextNode(expanderText));","     ",'     this.headingDiv.appendChild(document.createTextNode(" " + this.group.name));',"",'     this.contentDiv = this.mainDiv.appendChild(document.createElement("div"));','     var contentCssClass = this.group.expanded ? "expanded" : "collapsed";','     this.contentDiv.className = "groupcontent " + contentCssClass;',"","     this.expander.onclick = function() {","      if (groupElementContainer.group.expandable) {","       groupElementContainer.group.toggleExpanded();","      }","     };","    }","   }","","   GroupElementContainer.prototype = new LogItemContainerElement();","","   copyProperties(GroupElementContainer.prototype, {","    toggleExpanded: function() {","     if (!this.isRoot) {","      var oldCssClass, newCssClass, expanderText;","      if (this.group.expanded) {",'       newCssClass = "expanded";','       oldCssClass = "collapsed";','       expanderText = "-";',"      } else {",'       newCssClass = "collapsed";','       oldCssClass = "expanded";','       expanderText = "+";',"      }","      replaceClass(this.contentDiv, newCssClass, oldCssClass);","      this.expanderTextNode.nodeValue = expanderText;","     }","    },","","    remove: function() {","     if (!this.isRoot) {","      this.headingDiv = null;","      this.expander.onclick = null;","      this.expander = null;","      this.expanderTextNode = null;","      this.contentDiv = null;","      this.containerDomNode = null;","      this.mainDiv.parentNode.removeChild(this.mainDiv);","      this.mainDiv = null;","     }","    },","","    reverseChildren: function() {","     // Invert the order of the log entries","     var node = null;","","     // Remove all the log container nodes","     var childDomNodes = [];","     while ((node = this.contentDiv.firstChild)) {","      this.contentDiv.removeChild(node);","      childDomNodes.push(node);","     }","","     // Put them all back in reverse order","     while ((node = childDomNodes.pop())) {","      this.contentDiv.appendChild(node);","     }","    },","","    update: function() {","     if (!this.isRoot) {","      if (this.group.expandable) {",'       removeClass(this.expander, "greyedout");',"      } else {",'       addClass(this.expander, "greyedout");',"      }","     }","    },","","    clear: function() {","     if (this.isRoot) {",'      this.contentDiv.innerHTML = "";',"     }","    }","   });","","   /*----------------------------------------------------------------*/","","   function Group(name, isRoot, initiallyExpanded) {","    this.name = name;","    this.group = null;","    this.isRoot = isRoot;","    this.initiallyExpanded = initiallyExpanded;","    this.elementContainers = [];","    this.children = [];","    this.expanded = initiallyExpanded;","    this.rendered = false;","    this.expandable = false;","   }","","   Group.prototype = new LogItem();","","   copyProperties(Group.prototype, {","    addChild: function(logItem) {","     this.children.push(logItem);","     logItem.group = this;","    },","","    render: function() {","     if (isIe) {","      var unwrappedDomContainer, wrappedDomContainer;","      if (this.isRoot) {","       unwrappedDomContainer = logMainContainer;","       wrappedDomContainer = logMainContainer;","      } else {","       unwrappedDomContainer = this.getUnwrappedDomContainer();","       wrappedDomContainer = this.getWrappedDomContainer();","      }","      this.unwrappedElementContainer = new GroupElementContainer(this, unwrappedDomContainer, this.isRoot, false);","      this.wrappedElementContainer = new GroupElementContainer(this, wrappedDomContainer, this.isRoot, true);","      this.elementContainers = [this.unwrappedElementContainer, this.wrappedElementContainer];","     } else {","      var mainDomContainer = this.isRoot ? logMainContainer : this.getMainDomContainer();","      this.mainElementContainer = new GroupElementContainer(this, mainDomContainer, this.isRoot, false);","      this.elementContainers = [this.mainElementContainer];","     }","     this.rendered = true;","    },","","    toggleExpanded: function() {","     this.expanded = !this.expanded;","     for (var i = 0, len = this.elementContainers.length; i < len; i++) {","      this.elementContainers[i].toggleExpanded();","     }","    },","","    expand: function() {","     if (!this.expanded) {","      this.toggleExpanded();","     }","    },","","    accept: function(visitor) {","     visitor.visitGroup(this);","    },","","    reverseChildren: function() {","     if (this.rendered) {","      for (var i = 0, len = this.elementContainers.length; i < len; i++) {","       this.elementContainers[i].reverseChildren();","      }","     }","    },","","    update: function() {","     var previouslyExpandable = this.expandable;","     this.expandable = (this.children.length !== 0);","     if (this.expandable !== previouslyExpandable) {","      for (var i = 0, len = this.elementContainers.length; i < len; i++) {","       this.elementContainers[i].update();","      }","     }","    },","","    flatten: function() {","     var visitor = new GroupFlattener();","     this.accept(visitor);","     return visitor.logEntriesAndSeparators;","    },","","    removeChild: function(child, doUpdate) {","     arrayRemove(this.children, child);","     child.group = null;","     if (doUpdate) {","      this.update();","     }","    },","","    remove: function(doUpdate, removeFromGroup) {","     for (var i = 0, len = this.children.length; i < len; i++) {","      this.children[i].remove(false, false);","     }","     this.children = [];","     this.update();","     if (this === currentGroup) {","      currentGroup = this.group;","     }","     this.doRemove(doUpdate, removeFromGroup);","    },","","    serialize: function(items) {","     items.push([LogItem.serializedItemKeys.GROUP_START, this.name]);","     for (var i = 0, len = this.children.length; i < len; i++) {","      this.children[i].serialize(items);","     }","     if (this !== currentGroup) {","      items.push([LogItem.serializedItemKeys.GROUP_END]);","     }","    },","","    clear: function() {","     for (var i = 0, len = this.elementContainers.length; i < len; i++) {","      this.elementContainers[i].clear();","     }","    }","   });","","   /*----------------------------------------------------------------*/","","   function LogEntryElementContainer() {","   }","","   LogEntryElementContainer.prototype = new LogItemContainerElement();","","   copyProperties(LogEntryElementContainer.prototype, {","    remove: function() {","     this.doRemove();","    },","","    doRemove: function() {","     this.mainDiv.parentNode.removeChild(this.mainDiv);","     this.mainDiv = null;","     this.contentElement = null;","     this.containerDomNode = null;","    },","","    setContent: function(content, wrappedContent) {","     if (content === this.formattedMessage) {",'      this.contentElement.innerHTML = "";',"      this.contentElement.appendChild(document.createTextNode(this.formattedMessage));","     } else {","      this.contentElement.innerHTML = content;","     }","    },","","    setSearchMatch: function(isMatch) {",'     var oldCssClass = isMatch ? "searchnonmatch" : "searchmatch";','     var newCssClass = isMatch ? "searchmatch" : "searchnonmatch";',"     replaceClass(this.mainDiv, newCssClass, oldCssClass);","    },","","    clearSearch: function() {",'     removeClass(this.mainDiv, "searchmatch");','     removeClass(this.mainDiv, "searchnonmatch");',"    }","   });","","   /*----------------------------------------------------------------*/","","   function LogEntryWrappedElementContainer(logEntry, containerDomNode) {","    this.logEntry = logEntry;","    this.containerDomNode = containerDomNode;",'    this.mainDiv = document.createElement("div");',"    this.mainDiv.appendChild(document.createTextNode(this.logEntry.formattedMessage));",'    this.mainDiv.className = "logentry wrapped " + this.logEntry.level;',"    this.contentElement = this.mainDiv;","   }","","   LogEntryWrappedElementContainer.prototype = new LogEntryElementContainer();","","   LogEntryWrappedElementContainer.prototype.setContent = function(content, wrappedContent) {","    if (content === this.formattedMessage) {",'     this.contentElement.innerHTML = "";',"     this.contentElement.appendChild(document.createTextNode(this.formattedMessage));","    } else {","     this.contentElement.innerHTML = wrappedContent;","    }","   };","","   /*----------------------------------------------------------------*/","","   function LogEntryUnwrappedElementContainer(logEntry, containerDomNode) {","    this.logEntry = logEntry;","    this.containerDomNode = containerDomNode;",'    this.mainDiv = document.createElement("div");','    this.mainDiv.className = "logentry unwrapped " + this.logEntry.level;','    this.pre = this.mainDiv.appendChild(document.createElement("pre"));',"    this.pre.appendChild(document.createTextNode(this.logEntry.formattedMessage));",'    this.pre.className = "unwrapped";',"    this.contentElement = this.pre;","   }","","   LogEntryUnwrappedElementContainer.prototype = new LogEntryElementContainer();","","   LogEntryUnwrappedElementContainer.prototype.remove = function() {","    this.doRemove();","    this.pre = null;","   };","","   /*----------------------------------------------------------------*/","","   function LogEntryMainElementContainer(logEntry, containerDomNode) {","    this.logEntry = logEntry;","    this.containerDomNode = containerDomNode;",'    this.mainDiv = document.createElement("div");','    this.mainDiv.className = "logentry nonielogentry " + this.logEntry.level;','    this.contentElement = this.mainDiv.appendChild(document.createElement("span"));',"    this.contentElement.appendChild(document.createTextNode(this.logEntry.formattedMessage));","   }","","   LogEntryMainElementContainer.prototype = new LogEntryElementContainer();","","   /*----------------------------------------------------------------*/","","   function LogEntry(level, formattedMessage) {","    this.level = level;","    this.formattedMessage = formattedMessage;","    this.rendered = false;","   }","","   LogEntry.prototype = new LogItem();","","   copyProperties(LogEntry.prototype, {","    render: function() {","     var logEntry = this;","     var containerDomNode = this.group.contentDiv;","","     // Support for the CSS attribute white-space in IE for Windows is","     // non-existent pre version 6 and slightly odd in 6, so instead","     // use two different HTML elements","     if (isIe) {",'      this.formattedMessage = this.formattedMessage.replace(/\\r\\n/g, "\\r"); // Workaround for IE\'s treatment of white space',"      this.unwrappedElementContainer = new LogEntryUnwrappedElementContainer(this, this.getUnwrappedDomContainer());","      this.wrappedElementContainer = new LogEntryWrappedElementContainer(this, this.getWrappedDomContainer());","      this.elementContainers = [this.unwrappedElementContainer, this.wrappedElementContainer];","     } else {","      this.mainElementContainer = new LogEntryMainElementContainer(this, this.getMainDomContainer());","      this.elementContainers = [this.mainElementContainer];","     }","     this.content = this.formattedMessage;","     this.rendered = true;","    },","","    setContent: function(content, wrappedContent) {","     if (content != this.content) {","      if (isIe && (content !== this.formattedMessage)) {",'       content = content.replace(/\\r\\n/g, "\\r"); // Workaround for IE\'s treatment of white space',"      }","      for (var i = 0, len = this.elementContainers.length; i < len; i++) {","       this.elementContainers[i].setContent(content, wrappedContent);","      }","      this.content = content;","     }","    },","","    getSearchMatches: function() {","     var matches = [];","     var i, len;","     if (isIe) {",'      var unwrappedEls = getElementsByClass(this.unwrappedElementContainer.mainDiv, "searchterm", "span");','      var wrappedEls = getElementsByClass(this.wrappedElementContainer.mainDiv, "searchterm", "span");',"      for (i = 0, len = unwrappedEls.length; i < len; i++) {","       matches[i] = new Match(this.level, null, unwrappedEls[i], wrappedEls[i]);","      }","     } else {",'      var els = getElementsByClass(this.mainElementContainer.mainDiv, "searchterm", "span");',"      for (i = 0, len = els.length; i < len; i++) {","       matches[i] = new Match(this.level, els[i]);","      }","     }","     return matches;","    },","","    setSearchMatch: function(isMatch) {","     for (var i = 0, len = this.elementContainers.length; i < len; i++) {","      this.elementContainers[i].setSearchMatch(isMatch);","     }","    },","","    clearSearch: function() {","     for (var i = 0, len = this.elementContainers.length; i < len; i++) {","      this.elementContainers[i].clearSearch();","     }","    },","","    accept: function(visitor) {","     visitor.visitLogEntry(this);","    },","","    serialize: function(items) {","     items.push([LogItem.serializedItemKeys.LOG_ENTRY, this.level, this.formattedMessage]);","    }","   });","","   /*----------------------------------------------------------------*/","","   function LogItemVisitor() {","   }","","   LogItemVisitor.prototype = {","    visit: function(logItem) {","    },","","    visitParent: function(logItem) {","     if (logItem.group) {","      logItem.group.accept(this);","     }","    },","","    visitChildren: function(logItem) {","     for (var i = 0, len = logItem.children.length; i < len; i++) {","      logItem.children[i].accept(this);","     }","    },","","    visitLogEntry: function(logEntry) {","     this.visit(logEntry);","    },","","    visitSeparator: function(separator) {","     this.visit(separator);","    },","","    visitGroup: function(group) {","     this.visit(group);","    }","   };","","   /*----------------------------------------------------------------*/","","   function GroupFlattener() {","    this.logEntriesAndSeparators = [];","   }","","   GroupFlattener.prototype = new LogItemVisitor();","","   GroupFlattener.prototype.visitGroup = function(group) {","    this.visitChildren(group);","   };","","   GroupFlattener.prototype.visitLogEntry = function(logEntry) {","    this.logEntriesAndSeparators.push(logEntry);","   };","","   GroupFlattener.prototype.visitSeparator = function(separator) {","    this.logEntriesAndSeparators.push(separator);","   };","","   /*----------------------------------------------------------------*/","","   window.onload = function() {","    // Sort out document.domain","    if (location.search) {",'     var queryBits = unescape(location.search).substr(1).split("&"), nameValueBits;',"     for (var i = 0, len = queryBits.length; i < len; i++) {",'      nameValueBits = queryBits[i].split("=");','      if (nameValueBits[0] == "log4javascript_domain") {',"       document.domain = nameValueBits[1];","       break;","      }","     }","    }","","    // Create DOM objects",'    logMainContainer = $("log");',"    if (isIePre7) {",'     addClass(logMainContainer, "oldIe");',"    }","",'    rootGroup = new Group("root", true);',"    rootGroup.render();","    currentGroup = rootGroup;","    ","    setCommandInputWidth();","    setLogContainerHeight();","    toggleLoggingEnabled();","    toggleSearchEnabled();","    toggleSearchFilter();","    toggleSearchHighlight();","    applyFilters();","    checkAllLevels();","    toggleWrap();","    toggleNewestAtTop();","    toggleScrollToLatest();","    renderQueuedLogItems();","    loaded = true;",'    $("command").value = "";','    $("command").autocomplete = "off";','    $("command").onkeydown = function(evt) {',"     evt = getEvent(evt);","     if (evt.keyCode == 10 || evt.keyCode == 13) { // Return/Enter","      evalCommandLine();","      stopPropagation(evt);","     } else if (evt.keyCode == 27) { // Escape",'      this.value = "";',"      this.focus();","     } else if (evt.keyCode == 38 && commandHistory.length > 0) { // Up","      currentCommandIndex = Math.max(0, currentCommandIndex - 1);","      this.value = commandHistory[currentCommandIndex];","      moveCaretToEnd(this);","     } else if (evt.keyCode == 40 && commandHistory.length > 0) { // Down","      currentCommandIndex = Math.min(commandHistory.length - 1, currentCommandIndex + 1);","      this.value = commandHistory[currentCommandIndex];","      moveCaretToEnd(this);","     }","    };","","    // Prevent the keypress moving the caret in Firefox",'    $("command").onkeypress = function(evt) {',"     evt = getEvent(evt);","     if (evt.keyCode == 38 && commandHistory.length > 0 && evt.preventDefault) { // Up","      evt.preventDefault();","     }","    };","","    // Prevent the keyup event blurring the input in Opera",'    $("command").onkeyup = function(evt) {',"     evt = getEvent(evt);","     if (evt.keyCode == 27 && evt.preventDefault) { // Up","      evt.preventDefault();","      this.focus();","     }","    };","","    // Add document keyboard shortcuts","    document.onkeydown = function keyEventHandler(evt) {","     evt = getEvent(evt);","     switch (evt.keyCode) {","      case 69: // Ctrl + shift + E: re-execute last command","       if (evt.shiftKey && (evt.ctrlKey || evt.metaKey)) {","        evalLastCommand();","        cancelKeyEvent(evt);","        return false;","       }","       break;","      case 75: // Ctrl + shift + K: focus search","       if (evt.shiftKey && (evt.ctrlKey || evt.metaKey)) {","        focusSearch();","        cancelKeyEvent(evt);","        return false;","       }","       break;","      case 40: // Ctrl + shift + down arrow: focus command line","      case 76: // Ctrl + shift + L: focus command line","       if (evt.shiftKey && (evt.ctrlKey || evt.metaKey)) {","        focusCommandLine();","        cancelKeyEvent(evt);","        return false;","       }","       break;","     }","    };","","    // Workaround to make sure log div starts at the correct size","    setTimeout(setLogContainerHeight, 20);","","    setShowCommandLine(showCommandLine);","    doSearch();","   };","","   window.onunload = function() {","    if (mainWindowExists()) {","     appender.unload();","    }","    appender = null;","   };","","   /*----------------------------------------------------------------*/","","   function toggleLoggingEnabled() {",'    setLoggingEnabled($("enableLogging").checked);',"   }","","   function setLoggingEnabled(enable) {","    loggingEnabled = enable;","   }","","   var appender = null;","","   function setAppender(appenderParam) {","    appender = appenderParam;","   }","","   function setShowCloseButton(showCloseButton) {",'    $("closeButton").style.display = showCloseButton ? "inline" : "none";',"   }","","   function setShowHideButton(showHideButton) {",'    $("hideButton").style.display = showHideButton ? "inline" : "none";',"   }","","   var newestAtTop = false;","","   /*----------------------------------------------------------------*/","","   function LogItemContentReverser() {","   }","   ","   LogItemContentReverser.prototype = new LogItemVisitor();","   ","   LogItemContentReverser.prototype.visitGroup = function(group) {","    group.reverseChildren();","    this.visitChildren(group);","   };","","   /*----------------------------------------------------------------*/","","   function setNewestAtTop(isNewestAtTop) {","    var oldNewestAtTop = newestAtTop;","    var i, iLen, j, jLen;","    newestAtTop = Boolean(isNewestAtTop);","    if (oldNewestAtTop != newestAtTop) {","     var visitor = new LogItemContentReverser();","     rootGroup.accept(visitor);","","     // Reassemble the matches array","     if (currentSearch) {","      var currentMatch = currentSearch.matches[currentMatchIndex];","      var matchIndex = 0;","      var matches = [];","      var actOnLogEntry = function(logEntry) {","       var logEntryMatches = logEntry.getSearchMatches();","       for (j = 0, jLen = logEntryMatches.length; j < jLen; j++) {","        matches[matchIndex] = logEntryMatches[j];","        if (currentMatch && logEntryMatches[j].equals(currentMatch)) {","         currentMatchIndex = matchIndex;","        }","        matchIndex++;","       }","      };","      if (newestAtTop) {","       for (i = logEntries.length - 1; i >= 0; i--) {","        actOnLogEntry(logEntries[i]);","       }","      } else {","       for (i = 0, iLen = logEntries.length; i < iLen; i++) {","        actOnLogEntry(logEntries[i]);","       }","      }","      currentSearch.matches = matches;","      if (currentMatch) {","       currentMatch.setCurrent();","      }","     } else if (scrollToLatest) {","      doScrollToLatest();","     }","    }",'    $("newestAtTop").checked = isNewestAtTop;',"   }","","   function toggleNewestAtTop() {",'    var isNewestAtTop = $("newestAtTop").checked;',"    setNewestAtTop(isNewestAtTop);","   }","","   var scrollToLatest = true;","","   function setScrollToLatest(isScrollToLatest) {","    scrollToLatest = isScrollToLatest;","    if (scrollToLatest) {","     doScrollToLatest();","    }",'    $("scrollToLatest").checked = isScrollToLatest;',"   }","","   function toggleScrollToLatest() {",'    var isScrollToLatest = $("scrollToLatest").checked;',"    setScrollToLatest(isScrollToLatest);","   }","","   function doScrollToLatest() {","    var l = logMainContainer;",'    if (typeof l.scrollTop != "undefined") {',"     if (newestAtTop) {","      l.scrollTop = 0;","     } else {","      var latestLogEntry = l.lastChild;","      if (latestLogEntry) {","       l.scrollTop = l.scrollHeight;","      }","     }","    }","   }","","   var closeIfOpenerCloses = true;","","   function setCloseIfOpenerCloses(isCloseIfOpenerCloses) {","    closeIfOpenerCloses = isCloseIfOpenerCloses;","   }","","   var maxMessages = null;","","   function setMaxMessages(max) {","    maxMessages = max;","    pruneLogEntries();","   }","","   var showCommandLine = false;","","   function setShowCommandLine(isShowCommandLine) {","    showCommandLine = isShowCommandLine;","    if (loaded) {",'     $("commandLine").style.display = showCommandLine ? "block" : "none";',"     setCommandInputWidth();","     setLogContainerHeight();","    }","   }","","   function focusCommandLine() {","    if (loaded) {",'     $("command").focus();',"    }","   }","","   function focusSearch() {","    if (loaded) {",'     $("searchBox").focus();',"    }","   }","","   function getLogItems() {","    var items = [];","    for (var i = 0, len = logItems.length; i < len; i++) {","     logItems[i].serialize(items);","    }","    return items;","   }","","   function setLogItems(items) {","    var loggingReallyEnabled = loggingEnabled;","    // Temporarily turn logging on","    loggingEnabled = true;","    for (var i = 0, len = items.length; i < len; i++) {","     switch (items[i][0]) {","      case LogItem.serializedItemKeys.LOG_ENTRY:","       log(items[i][1], items[i][2]);","       break;","      case LogItem.serializedItemKeys.GROUP_START:","       group(items[i][1]);","       break;","      case LogItem.serializedItemKeys.GROUP_END:","       groupEnd();","       break;","     }","    }","    loggingEnabled = loggingReallyEnabled;","   }","","   function log(logLevel, formattedMessage) {","    if (loggingEnabled) {","     var logEntry = new LogEntry(logLevel, formattedMessage);","     logEntries.push(logEntry);","     logEntriesAndSeparators.push(logEntry);","     logItems.push(logEntry);","     currentGroup.addChild(logEntry);","     if (loaded) {","      if (logQueuedEventsTimer !== null) {","       clearTimeout(logQueuedEventsTimer);","      }","      logQueuedEventsTimer = setTimeout(renderQueuedLogItems, renderDelay);","      unrenderedLogItemsExist = true;","     }","    }","   }","","   function renderQueuedLogItems() {","    logQueuedEventsTimer = null;","    var pruned = pruneLogEntries();","","    // Render any unrendered log entries and apply the current search to them","    var initiallyHasMatches = currentSearch ? currentSearch.hasMatches() : false;","    for (var i = 0, len = logItems.length; i < len; i++) {","     if (!logItems[i].rendered) {","      logItems[i].render();","      logItems[i].appendToLog();","      if (currentSearch && (logItems[i] instanceof LogEntry)) {","       currentSearch.applyTo(logItems[i]);","      }","     }","    }","    if (currentSearch) {","     if (pruned) {","      if (currentSearch.hasVisibleMatches()) {","       if (currentMatchIndex === null) {","        setCurrentMatchIndex(0);","       }","       displayMatches();","      } else {","       displayNoMatches();","      }","     } else if (!initiallyHasMatches && currentSearch.hasVisibleMatches()) {","      setCurrentMatchIndex(0);","      displayMatches();","     }","    }","    if (scrollToLatest) {","     doScrollToLatest();","    }","    unrenderedLogItemsExist = false;","   }","","   function pruneLogEntries() {","    if ((maxMessages !== null) && (logEntriesAndSeparators.length > maxMessages)) {","     var numberToDelete = logEntriesAndSeparators.length - maxMessages;","     var prunedLogEntries = logEntriesAndSeparators.slice(0, numberToDelete);","     if (currentSearch) {","      currentSearch.removeMatches(prunedLogEntries);","     }","     var group;","     for (var i = 0; i < numberToDelete; i++) {","      group = logEntriesAndSeparators[i].group;","      arrayRemove(logItems, logEntriesAndSeparators[i]);","      arrayRemove(logEntries, logEntriesAndSeparators[i]);","      logEntriesAndSeparators[i].remove(true, true);","      if (group.children.length === 0 && group !== currentGroup && group !== rootGroup) {","       arrayRemove(logItems, group);","       group.remove(true, true);","      }","     }","     logEntriesAndSeparators = array_removeFromStart(logEntriesAndSeparators, numberToDelete);","     return true;","    }","    return false;","   }","","   function group(name, startExpanded) {","    if (loggingEnabled) {",'     initiallyExpanded = (typeof startExpanded === "undefined") ? true : Boolean(startExpanded);',"     var newGroup = new Group(name, false, initiallyExpanded);","     currentGroup.addChild(newGroup);","     currentGroup = newGroup;","     logItems.push(newGroup);","     if (loaded) {","      if (logQueuedEventsTimer !== null) {","       clearTimeout(logQueuedEventsTimer);","      }","      logQueuedEventsTimer = setTimeout(renderQueuedLogItems, renderDelay);","      unrenderedLogItemsExist = true;","     }","    }","   }","","   function groupEnd() {","    currentGroup = (currentGroup === rootGroup) ? rootGroup : currentGroup.group;","   }","","   function mainPageReloaded() {","    currentGroup = rootGroup;","    var separator = new Separator();","    logEntriesAndSeparators.push(separator);","    logItems.push(separator);","    currentGroup.addChild(separator);","   }","","   function closeWindow() {","    if (appender && mainWindowExists()) {","     appender.close(true);","    } else {","     window.close();","    }","   }","","   function hide() {","    if (appender && mainWindowExists()) {","     appender.hide();","    }","   }","","   var mainWindow = window;",'   var windowId = "log4javascriptConsoleWindow_" + new Date().getTime() + "_" + ("" + Math.random()).substr(2);',"","   function setMainWindow(win) {","    mainWindow = win;","    mainWindow[windowId] = window;","    // If this is a pop-up, poll the opener to see if it's closed","    if (opener && closeIfOpenerCloses) {","     pollOpener();","    }","   }","","   function pollOpener() {","    if (closeIfOpenerCloses) {","     if (mainWindowExists()) {","      setTimeout(pollOpener, 500);","     } else {","      closeWindow();","     }","    }","   }","","   function mainWindowExists() {","    try {","     return (mainWindow && !mainWindow.closed &&","      mainWindow[windowId] == window);","    } catch (ex) {}","    return false;","   }","",'   var logLevels = ["TRACE", "DEBUG", "INFO", "WARN", "ERROR", "FATAL"];',"","   function getCheckBox(logLevel) {",'    return $("switch_" + logLevel);',"   }","","   function getIeWrappedLogContainer() {",'    return $("log_wrapped");',"   }","","   function getIeUnwrappedLogContainer() {",'    return $("log_unwrapped");',"   }","","   function applyFilters() {","    for (var i = 0; i < logLevels.length; i++) {","     if (getCheckBox(logLevels[i]).checked) {","      addClass(logMainContainer, logLevels[i]);","     } else {","      removeClass(logMainContainer, logLevels[i]);","     }","    }","    updateSearchFromFilters();","   }","","   function toggleAllLevels() {",'    var turnOn = $("switch_ALL").checked;',"    for (var i = 0; i < logLevels.length; i++) {","     getCheckBox(logLevels[i]).checked = turnOn;","     if (turnOn) {","      addClass(logMainContainer, logLevels[i]);","     } else {","      removeClass(logMainContainer, logLevels[i]);","     }","    }","   }","","   function checkAllLevels() {","    for (var i = 0; i < logLevels.length; i++) {","     if (!getCheckBox(logLevels[i]).checked) {",'      getCheckBox("ALL").checked = false;',"      return;","     }","    }",'    getCheckBox("ALL").checked = true;',"   }","","   function clearLog() {","    rootGroup.clear();","    currentGroup = rootGroup;","    logEntries = [];","    logItems = [];","    logEntriesAndSeparators = [];","     doSearch();","   }","","   function toggleWrap() {",'    var enable = $("wrap").checked;',"    if (enable) {",'     addClass(logMainContainer, "wrap");',"    } else {",'     removeClass(logMainContainer, "wrap");',"    }","    refreshCurrentMatch();","   }","","   /* ------------------------------------------------------------------- */","","   // Search","","   var searchTimer = null;","","   function scheduleSearch() {","    try {","     clearTimeout(searchTimer);","    } catch (ex) {","     // Do nothing","    }","    searchTimer = setTimeout(doSearch, 500);","   }","","   function Search(searchTerm, isRegex, searchRegex, isCaseSensitive) {","    this.searchTerm = searchTerm;","    this.isRegex = isRegex;","    this.searchRegex = searchRegex;","    this.isCaseSensitive = isCaseSensitive;","    this.matches = [];","   }","","   Search.prototype = {","    hasMatches: function() {","     return this.matches.length > 0;","    },","","    hasVisibleMatches: function() {","     if (this.hasMatches()) {","      for (var i = 0; i < this.matches.length; i++) {","       if (this.matches[i].isVisible()) {","        return true;","       }","      }","     }","     return false;","    },","","    match: function(logEntry) {","     var entryText = String(logEntry.formattedMessage);","     var matchesSearch = false;","     if (this.isRegex) {","      matchesSearch = this.searchRegex.test(entryText);","     } else if (this.isCaseSensitive) {","      matchesSearch = (entryText.indexOf(this.searchTerm) > -1);","     } else {","      matchesSearch = (entryText.toLowerCase().indexOf(this.searchTerm.toLowerCase()) > -1);","     }","     return matchesSearch;","    },","","    getNextVisibleMatchIndex: function() {","     for (var i = currentMatchIndex + 1; i < this.matches.length; i++) {","      if (this.matches[i].isVisible()) {","       return i;","      }","     }","     // Start again from the first match","     for (i = 0; i <= currentMatchIndex; i++) {","      if (this.matches[i].isVisible()) {","       return i;","      }","     }","     return -1;","    },","","    getPreviousVisibleMatchIndex: function() {","     for (var i = currentMatchIndex - 1; i >= 0; i--) {","      if (this.matches[i].isVisible()) {","       return i;","      }","     }","     // Start again from the last match","     for (var i = this.matches.length - 1; i >= currentMatchIndex; i--) {","      if (this.matches[i].isVisible()) {","       return i;","      }","     }","     return -1;","    },","","    applyTo: function(logEntry) {","     var doesMatch = this.match(logEntry);","     if (doesMatch) {","      logEntry.group.expand();","      logEntry.setSearchMatch(true);","      var logEntryContent;","      var wrappedLogEntryContent;",'      var searchTermReplacementStartTag = "<span class=\\"searchterm\\">";','      var searchTermReplacementEndTag = "<" + "/span>";','      var preTagName = isIe ? "pre" : "span";','      var preStartTag = "<" + preTagName + " class=\\"pre\\">";','      var preEndTag = "<" + "/" + preTagName + ">";',"      var startIndex = 0;","      var searchIndex, matchedText, textBeforeMatch;","      if (this.isRegex) {",'       var flags = this.isCaseSensitive ? "g" : "gi";','       var capturingRegex = new RegExp("(" + this.searchRegex.source + ")", flags);',"","       // Replace the search term with temporary tokens for the start and end tags",'       var rnd = ("" + Math.random()).substr(2);','       var startToken = "%%s" + rnd + "%%";','       var endToken = "%%e" + rnd + "%%";','       logEntryContent = logEntry.formattedMessage.replace(capturingRegex, startToken + "$1" + endToken);',"","       // Escape the HTML to get rid of angle brackets","       logEntryContent = escapeHtml(logEntryContent);","","       // Substitute the proper HTML back in for the search match","       var result;","       var searchString = logEntryContent;",'       logEntryContent = "";','       wrappedLogEntryContent = "";',"       while ((searchIndex = searchString.indexOf(startToken, startIndex)) > -1) {","        var endTokenIndex = searchString.indexOf(endToken, searchIndex);","        matchedText = searchString.substring(searchIndex + startToken.length, endTokenIndex);","        textBeforeMatch = searchString.substring(startIndex, searchIndex);","        logEntryContent += preStartTag + textBeforeMatch + preEndTag;","        logEntryContent += searchTermReplacementStartTag + preStartTag + matchedText +","         preEndTag + searchTermReplacementEndTag;","        if (isIe) {","         wrappedLogEntryContent += textBeforeMatch + searchTermReplacementStartTag +","          matchedText + searchTermReplacementEndTag;","        }","        startIndex = endTokenIndex + endToken.length;","       }","       logEntryContent += preStartTag + searchString.substr(startIndex) + preEndTag;","       if (isIe) {","        wrappedLogEntryContent += searchString.substr(startIndex);","       }","      } else {",'       logEntryContent = "";','       wrappedLogEntryContent = "";',"       var searchTermReplacementLength = searchTermReplacementStartTag.length +","        this.searchTerm.length + searchTermReplacementEndTag.length;","       var searchTermLength = this.searchTerm.length;","       var searchTermLowerCase = this.searchTerm.toLowerCase();","       var logTextLowerCase = logEntry.formattedMessage.toLowerCase();","       while ((searchIndex = logTextLowerCase.indexOf(searchTermLowerCase, startIndex)) > -1) {","        matchedText = escapeHtml(logEntry.formattedMessage.substr(searchIndex, this.searchTerm.length));","        textBeforeMatch = escapeHtml(logEntry.formattedMessage.substring(startIndex, searchIndex));","        var searchTermReplacement = searchTermReplacementStartTag +","         preStartTag + matchedText + preEndTag + searchTermReplacementEndTag;","        logEntryContent += preStartTag + textBeforeMatch + preEndTag + searchTermReplacement;","        if (isIe) {","         wrappedLogEntryContent += textBeforeMatch + searchTermReplacementStartTag +","          matchedText + searchTermReplacementEndTag;","        }","        startIndex = searchIndex + searchTermLength;","       }","       var textAfterLastMatch = escapeHtml(logEntry.formattedMessage.substr(startIndex));","       logEntryContent += preStartTag + textAfterLastMatch + preEndTag;","       if (isIe) {","        wrappedLogEntryContent += textAfterLastMatch;","       }","      }","      logEntry.setContent(logEntryContent, wrappedLogEntryContent);","      var logEntryMatches = logEntry.getSearchMatches();","      this.matches = this.matches.concat(logEntryMatches);","     } else {","      logEntry.setSearchMatch(false);","      logEntry.setContent(logEntry.formattedMessage, logEntry.formattedMessage);","     }","     return doesMatch;","    },","","    removeMatches: function(logEntries) {","     var matchesToRemoveCount = 0;","     var currentMatchRemoved = false;","     var matchesToRemove = [];","     var i, iLen, j, jLen;","","     // Establish the list of matches to be removed","     for (i = 0, iLen = this.matches.length; i < iLen; i++) {","      for (j = 0, jLen = logEntries.length; j < jLen; j++) {","       if (this.matches[i].belongsTo(logEntries[j])) {","        matchesToRemove.push(this.matches[i]);","        if (i === currentMatchIndex) {","         currentMatchRemoved = true;","        }","       }","      }","     }","","     // Set the new current match index if the current match has been deleted","     // This will be the first match that appears after the first log entry being","     // deleted, if one exists; otherwise, it's the first match overall","     var newMatch = currentMatchRemoved ? null : this.matches[currentMatchIndex];","     if (currentMatchRemoved) {","      for (i = currentMatchIndex, iLen = this.matches.length; i < iLen; i++) {","       if (this.matches[i].isVisible() && !arrayContains(matchesToRemove, this.matches[i])) {","        newMatch = this.matches[i];","        break;","       }","      }","     }","","     // Remove the matches","     for (i = 0, iLen = matchesToRemove.length; i < iLen; i++) {","      arrayRemove(this.matches, matchesToRemove[i]);","      matchesToRemove[i].remove();","     }","","     // Set the new match, if one exists","     if (this.hasVisibleMatches()) {","      if (newMatch === null) {","       setCurrentMatchIndex(0);","      } else {","       // Get the index of the new match","       var newMatchIndex = 0;","       for (i = 0, iLen = this.matches.length; i < iLen; i++) {","        if (newMatch === this.matches[i]) {","         newMatchIndex = i;","         break;","        }","       }","       setCurrentMatchIndex(newMatchIndex);","      }","     } else {","      currentMatchIndex = null;","      displayNoMatches();","     }","    }","   };","","   function getPageOffsetTop(el, container) {","    var currentEl = el;","    var y = 0;","    while (currentEl && currentEl != container) {","     y += currentEl.offsetTop;","     currentEl = currentEl.offsetParent;","    }","    return y;","   }","","   function scrollIntoView(el) {","    var logContainer = logMainContainer;","    // Check if the whole width of the element is visible and centre if not",'    if (!$("wrap").checked) {',"     var logContainerLeft = logContainer.scrollLeft;","     var logContainerRight = logContainerLeft  + logContainer.offsetWidth;","     var elLeft = el.offsetLeft;","     var elRight = elLeft + el.offsetWidth;","     if (elLeft < logContainerLeft || elRight > logContainerRight) {","      logContainer.scrollLeft = elLeft - (logContainer.offsetWidth - el.offsetWidth) / 2;","     }","    }","    // Check if the whole height of the element is visible and centre if not","    var logContainerTop = logContainer.scrollTop;","    var logContainerBottom = logContainerTop  + logContainer.offsetHeight;","    var elTop = getPageOffsetTop(el) - getToolBarsHeight();","    var elBottom = elTop + el.offsetHeight;","    if (elTop < logContainerTop || elBottom > logContainerBottom) {","     logContainer.scrollTop = elTop - (logContainer.offsetHeight - el.offsetHeight) / 2;","    }","   }","","   function Match(logEntryLevel, spanInMainDiv, spanInUnwrappedPre, spanInWrappedDiv) {","    this.logEntryLevel = logEntryLevel;","    this.spanInMainDiv = spanInMainDiv;","    if (isIe) {","     this.spanInUnwrappedPre = spanInUnwrappedPre;","     this.spanInWrappedDiv = spanInWrappedDiv;","    }","    this.mainSpan = isIe ? spanInUnwrappedPre : spanInMainDiv;","   }","","   Match.prototype = {","    equals: function(match) {","     return this.mainSpan === match.mainSpan;","    },","","    setCurrent: function() {","     if (isIe) {",'      addClass(this.spanInUnwrappedPre, "currentmatch");','      addClass(this.spanInWrappedDiv, "currentmatch");',"      // Scroll the visible one into view",'      var elementToScroll = $("wrap").checked ? this.spanInWrappedDiv : this.spanInUnwrappedPre;',"      scrollIntoView(elementToScroll);","     } else {",'      addClass(this.spanInMainDiv, "currentmatch");',"      scrollIntoView(this.spanInMainDiv);","     }","    },","","    belongsTo: function(logEntry) {","     if (isIe) {","      return isDescendant(this.spanInUnwrappedPre, logEntry.unwrappedPre);","     } else {","      return isDescendant(this.spanInMainDiv, logEntry.mainDiv);","     }","    },","","    setNotCurrent: function() {","     if (isIe) {",'      removeClass(this.spanInUnwrappedPre, "currentmatch");','      removeClass(this.spanInWrappedDiv, "currentmatch");',"     } else {",'      removeClass(this.spanInMainDiv, "currentmatch");',"     }","    },","","    isOrphan: function() {","     return isOrphan(this.mainSpan);","    },","","    isVisible: function() {","     return getCheckBox(this.logEntryLevel).checked;","    },","","    remove: function() {","     if (isIe) {","      this.spanInUnwrappedPre = null;","      this.spanInWrappedDiv = null;","     } else {","      this.spanInMainDiv = null;","     }","    }","   };","","   var currentSearch = null;","   var currentMatchIndex = null;","","   function doSearch() {",'    var searchBox = $("searchBox");',"    var searchTerm = searchBox.value;",'    var isRegex = $("searchRegex").checked;','    var isCaseSensitive = $("searchCaseSensitive").checked;',"    var i;","",'    if (searchTerm === "") {','     $("searchReset").disabled = true;','     $("searchNav").style.display = "none";','     removeClass(document.body, "searching");','     removeClass(searchBox, "hasmatches");','     removeClass(searchBox, "nomatches");',"     for (i = 0; i < logEntries.length; i++) {","      logEntries[i].clearSearch();","      logEntries[i].setContent(logEntries[i].formattedMessage, logEntries[i].formattedMessage);","     }","     currentSearch = null;","     setLogContainerHeight();","    } else {",'     $("searchReset").disabled = false;','     $("searchNav").style.display = "block";',"     var searchRegex;","     var regexValid;","     if (isRegex) {","      try {",'       searchRegex = isCaseSensitive ? new RegExp(searchTerm, "g") : new RegExp(searchTerm, "gi");',"       regexValid = true;",'       replaceClass(searchBox, "validregex", "invalidregex");','       searchBox.title = "Valid regex";',"      } catch (ex) {","       regexValid = false;",'       replaceClass(searchBox, "invalidregex", "validregex");','       searchBox.title = "Invalid regex: " + (ex.message ? ex.message : (ex.description ? ex.description : "unknown error"));',"       return;","      }","     } else {",'      searchBox.title = "";','      removeClass(searchBox, "validregex");','      removeClass(searchBox, "invalidregex");',"     }",'     addClass(document.body, "searching");',"     currentSearch = new Search(searchTerm, isRegex, searchRegex, isCaseSensitive);","     for (i = 0; i < logEntries.length; i++) {","      currentSearch.applyTo(logEntries[i]);","     }","     setLogContainerHeight();","","     // Highlight the first search match","     if (currentSearch.hasVisibleMatches()) {","      setCurrentMatchIndex(0);","      displayMatches();","     } else {","      displayNoMatches();","     }","    }","   }","","   function updateSearchFromFilters() {","    if (currentSearch) {","     if (currentSearch.hasMatches()) {","      if (currentMatchIndex === null) {","       currentMatchIndex = 0;","      }","      var currentMatch = currentSearch.matches[currentMatchIndex];","      if (currentMatch.isVisible()) {","       displayMatches();","       setCurrentMatchIndex(currentMatchIndex);","      } else {","       currentMatch.setNotCurrent();","       // Find the next visible match, if one exists","       var nextVisibleMatchIndex = currentSearch.getNextVisibleMatchIndex();","       if (nextVisibleMatchIndex > -1) {","        setCurrentMatchIndex(nextVisibleMatchIndex);","        displayMatches();","       } else {","        displayNoMatches();","       }","      }","     } else {","      displayNoMatches();","     }","    }","   }","","   function refreshCurrentMatch() {","    if (currentSearch && currentSearch.hasVisibleMatches()) {","     setCurrentMatchIndex(currentMatchIndex);","    }","   }","","   function displayMatches() {",'    replaceClass($("searchBox"), "hasmatches", "nomatches");','    $("searchBox").title = "" + currentSearch.matches.length + " matches found";','    $("searchNav").style.display = "block";',"    setLogContainerHeight();","   }","","   function displayNoMatches() {",'    replaceClass($("searchBox"), "nomatches", "hasmatches");','    $("searchBox").title = "No matches found";','    $("searchNav").style.display = "none";',"    setLogContainerHeight();","   }","","   function toggleSearchEnabled(enable) {",'    enable = (typeof enable == "undefined") ? !$("searchDisable").checked : enable;','    $("searchBox").disabled = !enable;','    $("searchReset").disabled = !enable;','    $("searchRegex").disabled = !enable;','    $("searchNext").disabled = !enable;','    $("searchPrevious").disabled = !enable;','    $("searchCaseSensitive").disabled = !enable;','    $("searchNav").style.display = (enable && ($("searchBox").value !== "") &&',"      currentSearch && currentSearch.hasVisibleMatches()) ?",'     "block" : "none";',"    if (enable) {",'     removeClass($("search"), "greyedout");','     addClass(document.body, "searching");','     if ($("searchHighlight").checked) {','      addClass(logMainContainer, "searchhighlight");',"     } else {",'      removeClass(logMainContainer, "searchhighlight");',"     }",'     if ($("searchFilter").checked) {','      addClass(logMainContainer, "searchfilter");',"     } else {",'      removeClass(logMainContainer, "searchfilter");',"     }",'     $("searchDisable").checked = !enable;',"    } else {",'     addClass($("search"), "greyedout");','     removeClass(document.body, "searching");','     removeClass(logMainContainer, "searchhighlight");','     removeClass(logMainContainer, "searchfilter");',"    }","    setLogContainerHeight();","   }","","   function toggleSearchFilter() {",'    var enable = $("searchFilter").checked;',"    if (enable) {",'     addClass(logMainContainer, "searchfilter");',"    } else {",'     removeClass(logMainContainer, "searchfilter");',"    }","    refreshCurrentMatch();","   }","","   function toggleSearchHighlight() {",'    var enable = $("searchHighlight").checked;',"    if (enable) {",'     addClass(logMainContainer, "searchhighlight");',"    } else {",'     removeClass(logMainContainer, "searchhighlight");',"    }","   }","","   function clearSearch() {",'    $("searchBox").value = "";',"    doSearch();","   }","","   function searchNext() {","    if (currentSearch !== null && currentMatchIndex !== null) {","     currentSearch.matches[currentMatchIndex].setNotCurrent();","     var nextMatchIndex = currentSearch.getNextVisibleMatchIndex();",'     if (nextMatchIndex > currentMatchIndex || confirm("Reached the end of the page. Start from the top?")) {',"      setCurrentMatchIndex(nextMatchIndex);","     }","    }","   }","","   function searchPrevious() {","    if (currentSearch !== null && currentMatchIndex !== null) {","     currentSearch.matches[currentMatchIndex].setNotCurrent();","     var previousMatchIndex = currentSearch.getPreviousVisibleMatchIndex();",'     if (previousMatchIndex < currentMatchIndex || confirm("Reached the start of the page. Continue from the bottom?")) {',"      setCurrentMatchIndex(previousMatchIndex);","     }","    }","   }","","   function setCurrentMatchIndex(index) {","    currentMatchIndex = index;","    currentSearch.matches[currentMatchIndex].setCurrent();","   }","","   /* ------------------------------------------------------------------------- */","","   // CSS Utilities","","   function addClass(el, cssClass) {","    if (!hasClass(el, cssClass)) {","     if (el.className) {",'      el.className += " " + cssClass;',"     } else {","      el.className = cssClass;","     }","    }","   }","","   function hasClass(el, cssClass) {","    if (el.className) {",'     var classNames = el.className.split(" ");',"     return arrayContains(classNames, cssClass);","    }","    return false;","   }","","   function removeClass(el, cssClass) {","    if (hasClass(el, cssClass)) {","     // Rebuild the className property",'     var existingClasses = el.className.split(" ");',"     var newClasses = [];","     for (var i = 0, len = existingClasses.length; i < len; i++) {","      if (existingClasses[i] != cssClass) {","       newClasses[newClasses.length] = existingClasses[i];","      }","     }",'     el.className = newClasses.join(" ");',"    }","   }","","   function replaceClass(el, newCssClass, oldCssClass) {","    removeClass(el, oldCssClass);","    addClass(el, newCssClass);","   }","","   /* ------------------------------------------------------------------------- */","","   // Other utility functions","","   function getElementsByClass(el, cssClass, tagName) {","    var elements = el.getElementsByTagName(tagName);","    var matches = [];","    for (var i = 0, len = elements.length; i < len; i++) {","     if (hasClass(elements[i], cssClass)) {","      matches.push(elements[i]);","     }","    }","    return matches;","   }","","   // Syntax borrowed from Prototype library","   function $(id) {","    return document.getElementById(id);","   }","","   function isDescendant(node, ancestorNode) {","    while (node != null) {","     if (node === ancestorNode) {","      return true;","     }","     node = node.parentNode;","    }","    return false;","   }","","   function isOrphan(node) {","    var currentNode = node;","    while (currentNode) {","     if (currentNode == document.body) {","      return false;","     }","     currentNode = currentNode.parentNode;","    }","    return true;","   }","","   function escapeHtml(str) {",'    return str.replace(/&/g, "&amp;").replace(/[<]/g, "&lt;").replace(/>/g, "&gt;");',"   }","","   function getWindowWidth() {","    if (window.innerWidth) {","     return window.innerWidth;","    } else if (document.documentElement && document.documentElement.clientWidth) {","     return document.documentElement.clientWidth;","    } else if (document.body) {","     return document.body.clientWidth;","    }","    return 0;","   }","","   function getWindowHeight() {","    if (window.innerHeight) {","     return window.innerHeight;","    } else if (document.documentElement && document.documentElement.clientHeight) {","     return document.documentElement.clientHeight;","    } else if (document.body) {","     return document.body.clientHeight;","    }","    return 0;","   }","","   function getToolBarsHeight() {",'    return $("switches").offsetHeight;',"   }","","   function getChromeHeight() {","    var height = getToolBarsHeight();","    if (showCommandLine) {",'     height += $("commandLine").offsetHeight;',"    }","    return height;","   }","","   function setLogContainerHeight() {","    if (logMainContainer) {","     var windowHeight = getWindowHeight();",'     $("body").style.height = getWindowHeight() + "px";','     logMainContainer.style.height = "" +','      Math.max(0, windowHeight - getChromeHeight()) + "px";',"    }","   }","","   function setCommandInputWidth() {","    if (showCommandLine) {",'     $("command").style.width = "" + Math.max(0, $("commandLineContainer").offsetWidth -','      ($("evaluateButton").offsetWidth + 13)) + "px";',"    }","   }","","   window.onresize = function() {","    setCommandInputWidth();","    setLogContainerHeight();","   };","","   if (!Array.prototype.push) {","    Array.prototype.push = function() {","           for (var i = 0, len = arguments.length; i < len; i++){","               this[this.length] = arguments[i];","           }","           return this.length;","    };","   }","","   if (!Array.prototype.pop) {","    Array.prototype.pop = function() {","     if (this.length > 0) {","      var val = this[this.length - 1];","      this.length = this.length - 1;","      return val;","     }","    };","   }","","   if (!Array.prototype.shift) {","    Array.prototype.shift = function() {","     if (this.length > 0) {","      var firstItem = this[0];","      for (var i = 0, len = this.length - 1; i < len; i++) {","       this[i] = this[i + 1];","      }","      this.length = this.length - 1;","      return firstItem;","     }","    };","   }","","   if (!Array.prototype.splice) {","    Array.prototype.splice = function(startIndex, deleteCount) {","     var itemsAfterDeleted = this.slice(startIndex + deleteCount);","     var itemsDeleted = this.slice(startIndex, startIndex + deleteCount);","     this.length = startIndex;","     // Copy the arguments into a proper Array object","     var argumentsArray = [];","     for (var i = 0, len = arguments.length; i < len; i++) {","      argumentsArray[i] = arguments[i];","     }","     var itemsToAppend = (argumentsArray.length > 2) ?","      itemsAfterDeleted = argumentsArray.slice(2).concat(itemsAfterDeleted) : itemsAfterDeleted;","     for (i = 0, len = itemsToAppend.length; i < len; i++) {","      this.push(itemsToAppend[i]);","     }","     return itemsDeleted;","    };","   }","","   function arrayRemove(arr, val) {","    var index = -1;","    for (var i = 0, len = arr.length; i < len; i++) {","     if (arr[i] === val) {","      index = i;","      break;","     }","    }","    if (index >= 0) {","     arr.splice(index, 1);","     return index;","    } else {","     return false;","    }","   }","","   function array_removeFromStart(array, numberToRemove) {","    if (Array.prototype.splice) {","     array.splice(0, numberToRemove);","    } else {","     for (var i = numberToRemove, len = array.length; i < len; i++) {","      array[i - numberToRemove] = array[i];","     }","     array.length = array.length - numberToRemove;","    }","    return array;","   }","","   function arrayContains(arr, val) {","    for (var i = 0, len = arr.length; i < len; i++) {","     if (arr[i] == val) {","      return true;","     }","    }","    return false;","   }","","   function getErrorMessage(ex) {","    if (ex.message) {","     return ex.message;","    } else if (ex.description) {","     return ex.description;","    }",'    return "" + ex;',"   }","","   function moveCaretToEnd(input) {","    if (input.setSelectionRange) {","     input.focus();","     var length = input.value.length;","     input.setSelectionRange(length, length);","    } else if (input.createTextRange) {","     var range = input.createTextRange();","     range.collapse(false);","     range.select();","    }","    input.focus();","   }","","   function stopPropagation(evt) {","    if (evt.stopPropagation) {","     evt.stopPropagation();",'    } else if (typeof evt.cancelBubble != "undefined") {',"     evt.cancelBubble = true;","    }","   }","","   function getEvent(evt) {","    return evt ? evt : event;","   }","","   function getTarget(evt) {","    return evt.target ? evt.target : evt.srcElement;","   }","","   function getRelatedTarget(evt) {","    if (evt.relatedTarget) {","     return evt.relatedTarget;","    } else if (evt.srcElement) {","     switch(evt.type) {",'      case "mouseover":',"       return evt.fromElement;",'      case "mouseout":',"       return evt.toElement;","      default:","       return evt.srcElement;","     }","    }","   }","","   function cancelKeyEvent(evt) {","    evt.returnValue = false;","    stopPropagation(evt);","   }","","   function evalCommandLine() {",'    var expr = $("command").value;',"    evalCommand(expr);",'    $("command").value = "";',"   }","","   function evalLastCommand() {","    if (lastCommand != null) {","     evalCommand(lastCommand);","    }","   }","","   var lastCommand = null;","   var commandHistory = [];","   var currentCommandIndex = 0;","","   function evalCommand(expr) {","    if (appender) {","     appender.evalCommandAndAppend(expr);","    } else {",'     var prefix = ">>> " + expr + "\\r\\n";',"     try {",'      log("INFO", prefix + eval(expr));',"     } catch (ex) {",'      log("ERROR", prefix + "Error: " + getErrorMessage(ex));',"     }","    }","    // Update command history","    if (expr != commandHistory[commandHistory.length - 1]) {","     commandHistory.push(expr);","     // Update the appender","     if (appender) {","      appender.storeCommandHistory(commandHistory);","     }","    }","    currentCommandIndex = (expr == commandHistory[currentCommandIndex]) ? currentCommandIndex + 1 : commandHistory.length;","    lastCommand = expr;","   }","   //]]>","  </script>",'  <style type="text/css">',"   body {","    background-color: white;","    color: black;","    padding: 0;","    margin: 0;","    font-family: tahoma, verdana, arial, helvetica, sans-serif;","    overflow: hidden;","   }","","   div#switchesContainer input {","    margin-bottom: 0;","   }","","   div.toolbar {","    border-top: solid #ffffff 1px;","    border-bottom: solid #aca899 1px;","    background-color: #f1efe7;","    padding: 3px 5px;","    font-size: 68.75%;","   }","","   div.toolbar, div#search input {","    font-family: tahoma, verdana, arial, helvetica, sans-serif;","   }","","   div.toolbar input.button {","    padding: 0 5px;","    font-size: 100%;","   }","","   div.toolbar input.hidden {","    display: none;","   }","","   div#switches input#clearButton {","    margin-left: 20px;","   }","","   div#levels label {","    font-weight: bold;","   }","","   div#levels label, div#options label {","    margin-right: 5px;","   }","","   div#levels label#wrapLabel {","    font-weight: normal;","   }","","   div#search label {","    margin-right: 10px;","   }","","   div#search label.searchboxlabel {","    margin-right: 0;","   }","","   div#search input {","    font-size: 100%;","   }","","   div#search input.validregex {","    color: green;","   }","","   div#search input.invalidregex {","    color: red;","   }","","   div#search input.nomatches {","    color: white;","    background-color: #ff6666;","   }","","   div#search input.nomatches {","    color: white;","    background-color: #ff6666;","   }","","   div#searchNav {","    display: none;","   }","","   div#commandLine {","    display: none;","   }","","   div#commandLine input#command {","    font-size: 100%;","    font-family: Courier New, Courier;","   }","","   div#commandLine input#evaluateButton {","   }","","   *.greyedout {","    color: gray !important;","    border-color: gray !important;","   }","","   *.greyedout *.alwaysenabled { color: black; }","","   *.unselectable {","    -khtml-user-select: none;","    -moz-user-select: none;","    user-select: none;","   }","","   div#log {","    font-family: Courier New, Courier;","    font-size: 75%;","    width: 100%;","    overflow: auto;","    clear: both;","    position: relative;","   }","","   div.group {","    border-color: #cccccc;","    border-style: solid;","    border-width: 1px 0 1px 1px;","    overflow: visible;","   }","","   div.oldIe div.group, div.oldIe div.group *, div.oldIe *.logentry {","    height: 1%;","   }","","   div.group div.groupheading span.expander {","    border: solid black 1px;","    font-family: Courier New, Courier;","    font-size: 0.833em;","    background-color: #eeeeee;","    position: relative;","    top: -1px;","    color: black;","    padding: 0 2px;","    cursor: pointer;","    cursor: hand;","    height: 1%;","   }","","   div.group div.groupcontent {","    margin-left: 10px;","    padding-bottom: 2px;","    overflow: visible;","   }","","   div.group div.expanded {","    display: block;","   }","","   div.group div.collapsed {","    display: none;","   }","","   *.logentry {","    overflow: visible;","    display: none;","    white-space: pre;","   }","","   span.pre {","    white-space: pre;","   }","   ","   pre.unwrapped {","    display: inline !important;","   }","","   pre.unwrapped pre.pre, div.wrapped pre.pre {","    display: inline;","   }","","   div.wrapped pre.pre {","    white-space: normal;","   }","","   div.wrapped {","    display: none;","   }","","   body.searching *.logentry span.currentmatch {","    color: white !important;","    background-color: green !important;","   }","","   body.searching div.searchhighlight *.logentry span.searchterm {","    color: black;","    background-color: yellow;","   }","","   div.wrap *.logentry {","    white-space: normal !important;","    border-width: 0 0 1px 0;","    border-color: #dddddd;","    border-style: dotted;","   }","","   div.wrap #log_wrapped, #log_unwrapped {","    display: block;","   }","","   div.wrap #log_unwrapped, #log_wrapped {","    display: none;","   }","","   div.wrap *.logentry span.pre {","    overflow: visible;","    white-space: normal;","   }","","   div.wrap *.logentry pre.unwrapped {","    display: none;","   }","","   div.wrap *.logentry span.wrapped {","    display: inline;","   }","","   div.searchfilter *.searchnonmatch {","    display: none !important;","   }","","   div#log *.TRACE, label#label_TRACE {","    color: #666666;","   }","","   div#log *.DEBUG, label#label_DEBUG {","    color: green;","   }","","   div#log *.INFO, label#label_INFO {","    color: #000099;","   }","","   div#log *.WARN, label#label_WARN {","    color: #999900;","   }","","   div#log *.ERROR, label#label_ERROR {","    color: red;","   }","","   div#log *.FATAL, label#label_FATAL {","    color: #660066;","   }","","   div.TRACE#log *.TRACE,","   div.DEBUG#log *.DEBUG,","   div.INFO#log *.INFO,","   div.WARN#log *.WARN,","   div.ERROR#log *.ERROR,","   div.FATAL#log *.FATAL {","    display: block;","   }","","   div#log div.separator {","    background-color: #cccccc;","    margin: 5px 0;","    line-height: 1px;","   }","  </style>"," </head>","",' <body id="body">','  <div id="switchesContainer">','   <div id="switches">','    <div id="levels" class="toolbar">',"     Filters:",'     <input type="checkbox" id="switch_TRACE" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide trace messages" /><label for="switch_TRACE" id="label_TRACE">trace</label>','     <input type="checkbox" id="switch_DEBUG" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide debug messages" /><label for="switch_DEBUG" id="label_DEBUG">debug</label>','     <input type="checkbox" id="switch_INFO" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide info messages" /><label for="switch_INFO" id="label_INFO">info</label>','     <input type="checkbox" id="switch_WARN" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide warn messages" /><label for="switch_WARN" id="label_WARN">warn</label>','     <input type="checkbox" id="switch_ERROR" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide error messages" /><label for="switch_ERROR" id="label_ERROR">error</label>','     <input type="checkbox" id="switch_FATAL" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide fatal messages" /><label for="switch_FATAL" id="label_FATAL">fatal</label>','     <input type="checkbox" id="switch_ALL" onclick="toggleAllLevels(); applyFilters()" checked="checked" title="Show/hide all messages" /><label for="switch_ALL" id="label_ALL">all</label>',"    </div>",'    <div id="search" class="toolbar">','     <label for="searchBox" class="searchboxlabel">Search:</label> <input type="text" id="searchBox" onclick="toggleSearchEnabled(true)" onkeyup="scheduleSearch()" size="20" />','     <input type="button" id="searchReset" disabled="disabled" value="Reset" onclick="clearSearch()" class="button" title="Reset the search" />','     <input type="checkbox" id="searchRegex" onclick="doSearch()" title="If checked, search is treated as a regular expression" /><label for="searchRegex">Regex</label>','     <input type="checkbox" id="searchCaseSensitive" onclick="doSearch()" title="If checked, search is case sensitive" /><label for="searchCaseSensitive">Match case</label>','     <input type="checkbox" id="searchDisable" onclick="toggleSearchEnabled()" title="Enable/disable search" /><label for="searchDisable" class="alwaysenabled">Disable</label>','     <div id="searchNav">','      <input type="button" id="searchNext" disabled="disabled" value="Next" onclick="searchNext()" class="button" title="Go to the next matching log entry" />','      <input type="button" id="searchPrevious" disabled="disabled" value="Previous" onclick="searchPrevious()" class="button" title="Go to the previous matching log entry" />','      <input type="checkbox" id="searchFilter" onclick="toggleSearchFilter()" title="If checked, non-matching log entries are filtered out" /><label for="searchFilter">Filter</label>','      <input type="checkbox" id="searchHighlight" onclick="toggleSearchHighlight()" title="Highlight matched search terms" /><label for="searchHighlight" class="alwaysenabled">Highlight all</label>',"     </div>","    </div>",'    <div id="options" class="toolbar">',"     Options:",'     <input type="checkbox" id="enableLogging" onclick="toggleLoggingEnabled()" checked="checked" title="Enable/disable logging" /><label for="enableLogging" id="enableLoggingLabel">Log</label>','     <input type="checkbox" id="wrap" onclick="toggleWrap()" title="Enable / disable word wrap" /><label for="wrap" id="wrapLabel">Wrap</label>','     <input type="checkbox" id="newestAtTop" onclick="toggleNewestAtTop()" title="If checked, causes newest messages to appear at the top" /><label for="newestAtTop" id="newestAtTopLabel">Newest at the top</label>','     <input type="checkbox" id="scrollToLatest" onclick="toggleScrollToLatest()" checked="checked" title="If checked, window automatically scrolls to a new message when it is added" /><label for="scrollToLatest" id="scrollToLatestLabel">Scroll to latest</label>','     <input type="button" id="clearButton" value="Clear" onclick="clearLog()" class="button" title="Clear all log messages"  />','     <input type="button" id="hideButton" value="Hide" onclick="hide()" class="hidden button" title="Hide the console" />','     <input type="button" id="closeButton" value="Close" onclick="closeWindow()" class="hidden button" title="Close the window" />',"    </div>","   </div>","  </div>",'  <div id="log" class="TRACE DEBUG INFO WARN ERROR FATAL"></div>','  <div id="commandLine" class="toolbar">','   <div id="commandLineContainer">','    <input type="text" id="command" title="Enter a JavaScript command here and hit return or press \'Evaluate\'" />','    <input type="button" id="evaluateButton" value="Evaluate" class="button" title="Evaluate the command" onclick="evalCommandLine()" />',"   </div>","  </div>"," </body>","</html>",""]
},defaultCommandLineFunctions=[],consoleAppenderIdCounter=1;ConsoleAppender.prototype=new Appender,ConsoleAppender.prototype.create=function(a,b,c,d,e,f,g,h){function i(a,b){this.loggingEvent=a,this.levelName=a.level.name,this.formattedMessage=b}function j(a,b){this.name=a,this.initiallyExpanded=b}function k(){}var l=this,m=!1,n=!1,o=!1,p=!1,q=[],r=!0,s=consoleAppenderIdCounter++;d=extractBooleanFromParam(d,this.defaults.initiallyMinimized),c=extractBooleanFromParam(c,this.defaults.lazyInit),e=extractBooleanFromParam(e,this.defaults.useDocumentWrite);var t=this.defaults.newestMessageAtTop,u=this.defaults.scrollToLatestMessage;f=f?f:this.defaults.width,g=g?g:this.defaults.height;{var v=this.defaults.maxMessages,w=this.defaults.showCommandLine,x=this.defaults.commandLineObjectExpansionDepth,y=this.defaults.showHideButton,z=this.defaults.showCloseButton;this.defaults.showLogEntryDeleteButtons}this.setLayout(this.defaults.layout);var A,B,C,D,E,F=a?"InPageAppender":"PopUpAppender",G=function(a){return n?(handleError(F+': configuration option "'+a+'" may not be set after the appender has been initialized'),!1):!0},H=function(){return o&&r&&!p};this.isNewestMessageAtTop=function(){return t},this.setNewestMessageAtTop=function(a){t=toBool(a),H()&&D().setNewestAtTop(t)},this.isScrollToLatestMessage=function(){return u},this.setScrollToLatestMessage=function(a){u=toBool(a),H()&&D().setScrollToLatest(u)},this.getWidth=function(){return f},this.setWidth=function(a){G("width")&&(f=extractStringFromParam(a,f))},this.getHeight=function(){return g},this.setHeight=function(a){G("height")&&(g=extractStringFromParam(a,g))},this.getMaxMessages=function(){return v},this.setMaxMessages=function(a){v=extractIntFromParam(a,v),H()&&D().setMaxMessages(v)},this.isShowCommandLine=function(){return w},this.setShowCommandLine=function(a){w=toBool(a),H()&&D().setShowCommandLine(w)},this.isShowHideButton=function(){return y},this.setShowHideButton=function(a){y=toBool(a),H()&&D().setShowHideButton(y)},this.isShowCloseButton=function(){return z},this.setShowCloseButton=function(a){z=toBool(a),H()&&D().setShowCloseButton(z)},this.getCommandLineObjectExpansionDepth=function(){return x},this.setCommandLineObjectExpansionDepth=function(a){x=extractIntFromParam(a,x)};var I=d;this.isInitiallyMinimized=function(){return d},this.setInitiallyMinimized=function(a){G("initiallyMinimized")&&(d=toBool(a),I=d)},this.isUseDocumentWrite=function(){return e},this.setUseDocumentWrite=function(a){G("useDocumentWrite")&&(e=toBool(a))},i.prototype.append=function(){D().log(this.levelName,this.formattedMessage)},j.prototype.append=function(){D().group(this.name,this.initiallyExpanded)},k.prototype.append=function(){D().groupEnd()};var J=function(){C(),m?p&&$&&B():A(),C()&&K()};this.append=function(a){if(r){var b=l.getLayout().format(a);this.getLayout().ignoresThrowable()&&(b+=a.getThrowableStrRep()),q.push(new i(a,b)),J()}},this.group=function(a,b){r&&(q.push(new j(a,b)),J())},this.groupEnd=function(){r&&(q.push(new k),J())};var K=function(){for(;q.length>0;)q.shift().append();h&&D().focus()};this.setAddedToLogger=function(a){this.loggers.push(a),enabled&&!c&&A()},this.clear=function(){H()&&D().clearLog(),q.length=0},this.focus=function(){H()&&D().focus()},this.focusCommandLine=function(){H()&&D().focusCommandLine()},this.focusSearch=function(){H()&&D().focusSearch()};var L=window;this.getCommandWindow=function(){return L},this.setCommandWindow=function(a){L=a},this.executeLastCommand=function(){H()&&D().evalLastCommand()};var M=new PatternLayout("%m");this.getCommandLayout=function(){return M},this.setCommandLayout=function(a){M=a},this.evalCommandAndAppend=function(a){var b,c={appendResult:!0,isError:!1},d="";try{var e,f;!L.eval&&L.execScript&&L.execScript("null");var g={};for(f=0,b=N.length;b>f;f++)g[N[f][0]]=N[f][1];var h=[],i=function(a){h.push([a,L[a]])};i("appender"),L.appender=l,i("commandReturnValue"),L.commandReturnValue=c,i("commandLineFunctionsHash"),L.commandLineFunctionsHash=g;var j=function(a){i(a),L[a]=function(){return this.commandLineFunctionsHash[a](l,arguments,c)}};for(f=0,b=N.length;b>f;f++)j(N[f][0]);for(L===window&&L.execScript?(i("evalExpr"),i("result"),window.evalExpr=a,L.execScript("window.result=eval(window.evalExpr);"),e=window.result):e=L.eval(a),d=isUndefined(e)?e:formatObjectExpansion(e,x),f=0,b=h.length;b>f;f++)L[h[f][0]]=h[f][1]}catch(k){d="Error evaluating command: "+getExceptionStringRep(k),c.isError=!0}if(c.appendResult){var m=">>> "+a;isUndefined(d)||(m+=newLine+d);var n=c.isError?Level.ERROR:Level.INFO,o=new LoggingEvent(null,new Date,n,[m],null),p=this.getLayout();this.setLayout(M),this.append(o),this.setLayout(p)}};var N=defaultCommandLineFunctions.concat([]);this.addCommandLineFunction=function(a,b){N.push([a,b])};var O="log4javascriptCommandHistory";this.storeCommandHistory=function(a){setCookie(O,a.join(","))};var P=function(a){var b=getConsoleHtmlLines();a.open();for(var c=0,d=b.length;d>c;c++)a.writeln(b[c]);a.close()};this.setEventTypes(["load","unload"]);var Q=function(){var a=D();a.setAppender(l),a.setNewestAtTop(t),a.setScrollToLatest(u),a.setMaxMessages(v),a.setShowCommandLine(w),a.setShowHideButton(y),a.setShowCloseButton(z),a.setMainWindow(window);var b=getCookie(O);b&&(a.commandHistory=b.split(","),a.currentCommandIndex=a.commandHistory.length),l.dispatchEvent("load",{win:a})};this.unload=function(){logLog.debug("unload "+this+", caller: "+this.unload.caller),p||(logLog.debug("really doing unload "+this),p=!0,o=!1,n=!1,l.dispatchEvent("unload",{}))};var R=function(a,b,c,d){function e(){try{p&&clearInterval(f),a(D())&&(clearInterval(f),c())}catch(b){clearInterval(f),r=!1,handleError(d,b)}}var f=setInterval(e,b)},S=function(){var a=document.domain!==location.hostname;return e?"":getBaseUrl()+"console_uncompressed.html"+(a?"?log4javascript_domain="+window.escape(document.domain):"")};if(a){var T=null,U=[];this.addCssProperty=function(a,b){G("cssProperties")&&U.push([a,b])};var V,W=!1,X=uniqueId+"_InPageAppender_"+s;this.hide=function(){m&&n&&(H()&&D().$("command").blur(),V.style.display="none",I=!0)},this.show=function(){m&&(n?(V.style.display="block",this.setShowCommandLine(w),I=!1):W||B(!0))},this.isVisible=function(){return!I&&!p},this.close=function(a){p||a&&!confirm("This will permanently remove the console from the page. No more messages will be logged. Do you wish to continue?")||(V.parentNode.removeChild(V),this.unload())},E=function(){function a(){try{d||l.show(),Q(),o=!0,K()}catch(a){r=!1,handleError(c,a)}}function b(){try{var b=function(a){return isLoaded(a)};e&&P(D().document),b(D())?a():R(b,100,a,c)}catch(d){r=!1,handleError(c,d)}}var c="InPageAppender.open: unable to create console iframe";I=!1,V=T.appendChild(document.createElement("div")),V.style.width=f,V.style.height=g,V.style.border="solid gray 1px";for(var h=0,i=U.length;i>h;h++)V.style[U[h][0]]=U[h][1];var j=e?"":' src="'+S()+'"';V.innerHTML='<iframe id="'+X+'" name="'+X+'" width="100%" height="100%" frameborder="0"'+j+' scrolling="no"></iframe>',p=!1;var k=function(a){try{return toBool(a)&&(toBool(a.document)||toBool(a.contentDocument))}catch(b){return!1}};k(D())?b():R(k,100,b,c),n=!0},B=function(a){if(a||!d){var c=function(){if(b)try{var a=document.getElementById(b);1===a.nodeType&&(T=a),E()}catch(c){handleError('InPageAppender.init: invalid container element "'+b+'" supplied',c)}else T=document.createElement("div"),T.style.position="fixed",T.style.left="0",T.style.right="0",T.style.bottom="0",document.body.appendChild(T),l.addCssProperty("borderWidth","1px 0 0 0"),l.addCssProperty("zIndex",1e6),E()};pageLoaded&&b&&b.appendChild?(T=b,E()):pageLoaded?c():log4javascript.addEventListener("load",c),W=!0}},A=function(){B(),m=!0},D=function(){var a=window.frames[X];return a?a:void 0},C=function(){return r&&!p?(n&&!o&&D()&&isLoaded(D())&&(o=!0),o):!1}}else{var Y=l.defaults.useOldPopUp,Z=l.defaults.complainAboutPopUpBlocking,$=this.defaults.reopenWhenClosed;this.isUseOldPopUp=function(){return Y},this.setUseOldPopUp=function(a){G("useOldPopUp")&&(Y=toBool(a))},this.isComplainAboutPopUpBlocking=function(){return Z},this.setComplainAboutPopUpBlocking=function(a){G("complainAboutPopUpBlocking")&&(Z=toBool(a))},this.isFocusPopUp=function(){return h},this.setFocusPopUp=function(a){h=toBool(a)},this.isReopenWhenClosed=function(){return $},this.setReopenWhenClosed=function(a){$=toBool(a)},this.close=function(){logLog.debug("close "+this);try{_.close(),this.unload()}catch(a){}},this.hide=function(){logLog.debug("hide "+this),H()&&this.close()},this.show=function(){logLog.debug("show "+this),n||E()},this.isVisible=function(){return C()};var _;E=function(){function a(){D().setCloseIfOpenerCloses(!Y||!e),Q(),o=!0,K(),R(j,500,k,"PopUpAppender.checkPopUpClosed: error checking pop-up window")}var b="width="+f+",height="+g+",status,resizable",c="";try{var d=window.frameElement;d&&(c="_"+d.tagName+"_"+(d.name||d.id||""))}catch(h){c="_inaccessibleParentFrame"}var i="PopUp_"+location.host.replace(/[^a-z0-9]/gi,"_")+"_"+s+c;Y&&e||(i=i+"_"+uniqueId);var j=function(a){if(p)return!0;try{return toBool(a)&&a.closed}catch(b){}return!1},k=function(){p||l.unload()};try{if(_=window.open(S(),i,b),p=!1,n=!0,_&&_.document)if(e&&Y&&isLoaded(_))_.mainPageReloaded(),a();else{e&&P(_.document);var m=function(a){return toBool(a)&&isLoaded(a)};isLoaded(_)?a():R(m,100,a,"PopUpAppender.init: unable to create console window")}else r=!1,logLog.warn("PopUpAppender.init: pop-ups blocked, please unblock to use PopUpAppender"),Z&&handleError("log4javascript: pop-up windows appear to be blocked. Please unblock them to use pop-up logging.")}catch(q){handleError("PopUpAppender.init: error creating pop-up",q)}},B=function(){d||E()},A=function(){B(),m=!0},D=function(){return _},C=function(){if(r&&!isUndefined(_)&&!p){if(_.closed||o&&isUndefined(_.closed))return l.unload(),logLog.debug("PopUpAppender: pop-up closed"),!1;!o&&isLoaded(_)&&(o=!0)}return r&&o&&!p}}this.getConsoleWindow=D},ConsoleAppender.addGlobalCommandLineFunction=function(a,b){defaultCommandLineFunctions.push([a,b])},PopUpAppender.prototype=new ConsoleAppender,PopUpAppender.prototype.defaults={layout:new PatternLayout("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:!1,focusPopUp:!1,lazyInit:!0,useOldPopUp:!0,complainAboutPopUpBlocking:!0,newestMessageAtTop:!1,scrollToLatestMessage:!0,width:"600",height:"400",reopenWhenClosed:!1,maxMessages:null,showCommandLine:!0,commandLineObjectExpansionDepth:1,showHideButton:!1,showCloseButton:!0,showLogEntryDeleteButtons:!0,useDocumentWrite:!0},PopUpAppender.prototype.toString=function(){return"PopUpAppender"},log4javascript.PopUpAppender=PopUpAppender,InPageAppender.prototype=new ConsoleAppender,InPageAppender.prototype.defaults={layout:new PatternLayout("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:!1,lazyInit:!0,newestMessageAtTop:!1,scrollToLatestMessage:!0,width:"100%",height:"220px",maxMessages:null,showCommandLine:!0,commandLineObjectExpansionDepth:1,showHideButton:!1,showCloseButton:!1,showLogEntryDeleteButtons:!0,useDocumentWrite:!0},InPageAppender.prototype.toString=function(){return"InPageAppender"},log4javascript.InPageAppender=InPageAppender,log4javascript.InlineAppender=InPageAppender;var nodeTypes={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},preFormattedElements=["script","pre"],emptyElements=["br","img","hr","param","link","area","input","col","base","meta"],indentationUnit="  ";return init(),log4javascript});